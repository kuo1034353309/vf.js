!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,r="~";function i(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,o||t,i),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],s]:t._events[c].push(s):(t._events[c]=s,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)o.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,i,a){var s=r?r+t:t;if(!this._events[s])return!1;var c,u,p=this._events[s],l=arguments.length;if(p.fn){switch(p.once&&this.removeListener(t,p.fn,void 0,!0),l){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,e),!0;case 3:return p.fn.call(p.context,e,n),!0;case 4:return p.fn.call(p.context,e,n,o),!0;case 5:return p.fn.call(p.context,e,n,o,i),!0;case 6:return p.fn.call(p.context,e,n,o,i,a),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];p.fn.apply(p.context,c)}else{var h,f=p.length;for(u=0;u<f;u++)switch(p[u].once&&this.removeListener(t,p[u].fn,void 0,!0),l){case 1:p[u].fn.call(p[u].context);break;case 2:p[u].fn.call(p[u].context,e);break;case 3:p[u].fn.call(p[u].context,e,n);break;case 4:p[u].fn.call(p[u].context,e,n,o);break;default:if(!c)for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];p[u].fn.apply(p[u].context,c)}}return!0},u.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},u.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},u.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||n&&a.context!==n||c(this,i);else{for(var s=0,u=[],p=a.length;s<p;s++)(a[s].fn!==e||o&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&c(this,e)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},function(t,e,n){"use strict";n.r(e);var o,r,i={};n.r(i),n.d(i,"BoardDrawPlug",(function(){return Fe})),n.d(i,"SliderEditorPlug",(function(){return Ue})),n.d(i,"DigitalLibraryPlug",(function(){return Xe})),n.d(i,"PlugIndex",(function(){return Ye})),function(t){t[t.CONST=0]="CONST",t[t.VARIABLE=1]="VARIABLE",t[t.RANDOM=2]="RANDOM",t[t.STSTEN=3]="STSTEN",t[t.PROPERTY=4]="PROPERTY",t[t.OPERATION=5]="OPERATION",t[t.ARRAY_LEN=6]="ARRAY_LEN",t[t.ARRAY_VALUE=7]="ARRAY_VALUE",t[t.OBJECT_VALUE=8]="OBJECT_VALUE",t[t.PARAM_VALUE=9]="PARAM_VALUE",t[t.ARRAY_FUNCTION=10]="ARRAY_FUNCTION",t[t.COMPONENT=11]="COMPONENT"}(o||(o={})),function(t){t[t.TIME=0]="TIME",t[t.YEAR=1]="YEAR",t[t.MONTH=2]="MONTH",t[t.DAY=3]="DAY",t[t.DATE=4]="DATE"}(r||(r={}));var a,s=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(){var n=t.call(this)||this;return n.hashCode=++e.maxHashCode,n.libId="0",n.id="0",n.childrenMap={},n.pauseData=void 0,n.interactabled=!0,n}return s(e,t),Object.defineProperty(e.prototype,"vfStage",{get:function(){return this._vfStage},set:function(t){for(var n in this._vfStage=t,this.childrenMap)if(this.childrenMap[n]){var o=this.childrenMap[n];o instanceof e&&(o.vfStage=t)}},enumerable:!0,configurable:!0}),e.prototype.pause=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.pause()}this.animation&&(this.pauseData=this.animation.getPauseData(),this.animation.stop()),this.actionList&&this.actionList.pause()},e.prototype.resume=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.resume()}this.animation&&this.pauseData&&(this.animation.gotoPlay(this.pauseData.animation,this.pauseData.frame,this.pauseData.times),this.pauseData=void 0),this.actionList&&this.actionList.resume()},e.prototype.playDefaultAnimation=function(){this.animation&&this.animation.playDefaultAnimation()},e.prototype.gotoPlay=function(t,e,n){void 0===n&&(n=1),this.animation&&this.animation.gotoPlay(t,e,n)},e.prototype.gotoStop=function(t,e){this.animation&&this.animation.gotoStop(t,e)},e.prototype.play=function(t,e){void 0===e&&(e=1),this.animation&&this.animation.play(t,e)},e.prototype.stop=function(){this.animation&&this.animation.stop()},e.prototype.getChildById=function(t){return this.childrenMap[t]},e.prototype.getVariable=function(t){if(this._vfStage)return this._vfStage.variableManager.getVariable(this.hashCode.toString(),t)},e.prototype.getVariableValue=function(t){var e=this.getVariable(t);if(e)return e.value},e.prototype.setVariableValue=function(t,e){var n=this.getVariable(t);n&&(n.value=e)},e.prototype.addChildAt=function(n,o){var r=n.id;this.childrenMap[r.toString()]||(this.childrenMap[r.toString()]=n),n instanceof e&&(n.vfStage=this.vfStage);var i=t.prototype.addChildAt.call(this,n,o);return n instanceof e&&n.playDefaultAnimation(),i},e.prototype.removeChild=function(e){e.id;return t.prototype.removeChild.call(this,e)},e.prototype.runAction=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.runAction()}this.actionList&&this.actionList.run(),this.on("Remove",this.onRemoved,this)},e.prototype.emitAddToChildBefore=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.emitAddToChildBefore()}this.emit("Add",this)},e.prototype.emitAddToChild=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.emitAddToChild()}this.emit("Added",this)},e.prototype.emitRemoveToChild=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.emitRemoveToChild()}this.emit("Removed",this)},e.prototype.emitRemoveToChildBefore=function(){for(var t in this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.emitRemoveToChildBefore()}this.emit("Remove",this)},e.prototype.dispose=function(){for(var t in this._vfStage=void 0,this.interactabled=!1,this.animation&&this.animation.stop(),this.childrenMap)if(this.childrenMap[t]){var n=this.childrenMap[t];n instanceof e&&n.dispose()}this.releaseAll()},e.prototype.onRemoved=function(){this.actionList&&this.actionList.stop(),this.off("Remove")},e.maxHashCode=1e4,e}(vf.gui.ScrollingContainer),u=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=function(t){function e(n,o,r){return t.call(this,n||e.vertexSrc,o,r||e.crossFadeUniforms)||this}return u(e,t),e.prototype.apply=function(t,e,n){var o=new vf.Matrix;t.calculateNormalizedScreenSpaceMatrix(o),this.uniforms.filterMatrix=o,this.uniforms.resolution=vf.settings.RESOLUTION,t.applyFilter(this,e,n,void 0)},e.prototype.setPreviousTexture=function(t){this.uniforms.previousTexture=t},Object.defineProperty(e.prototype,"progress",{get:function(){return this.uniforms.progress},set:function(t){t=Math.min(1,t),t=Math.max(0,t),this.uniforms.progress=t},enumerable:!0,configurable:!0}),e.prototype.applyTranisition=function(t){this.target=t,this.target.filters=[this]},e.prototype.dispose=function(){this.target&&(this.target.filters=[])},e.vertexSrc="\n            precision highp float;\n            \n            attribute vec2 aVertexPosition;\n            attribute vec2 aTextureCoord;\n            attribute vec4 aColor;\n            \n            uniform mat3 projectionMatrix;\n            uniform mat3 filterMatrix;\n            uniform vec4 inputSize;\n            uniform vec4 outputFrame;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            void main(void){\n                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n                // filterMatrix.xy = ((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw;\n                vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy / resolution;\n                // vFilterCoord = (((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw) * aTextureCoord / resolution;\n                vTextureCoord = aTextureCoord ;\n            }\n        ",e.crossFadeUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0},e}(vf.Filter),l=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=function(t){function e(){return t.call(this,"",e.fragmentSrc)||this}return l(e,t),e.fragmentSrc="\n            precision mediump float;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            varying vec2 vFilterCoord;\n            varying vec2 vTextureCoord;\n            void main()\n            {\n                vec4 col = texture2D(previousTexture, vFilterCoord);\n                vec4 col2 = texture2D(uSampler, vTextureCoord);\n                gl_FragColor = vec4(mix(col, col2, progress));\n            }\n        ",e}(p),f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=function(t){function e(){return t.call(this,"",e.fragmentSrc)||this}return f(e,t),e.fragmentSrc="\n            precision mediump float;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n\n            uniform highp vec4 inputSize;\n            uniform highp vec4 outputFrame;\n\n            varying vec2 vFilterCoord;\n            varying vec2 vTextureCoord;\n\n            void main()\n            {\n                float m = outputFrame.z / 2000.0;\n                float t = inputSize.y / inputSize.x;\n                vec2 circle = vFilterCoord - 0.5;\n                circle.y = circle.y * t;\n                float d = length(circle);\n                float p2 = progress * progress;\n                if(d > p2) {\n                    gl_FragColor = texture2D(previousTexture, vFilterCoord);\n                } else {\n                    gl_FragColor = texture2D(uSampler, vTextureCoord);\n                }\n                gl_FragColor = vec4(m, 0.0, 0.0, 1.0);\n            }\n        ",e}(p),v=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.linearBlurUniforms)||this}return v(e,t),e.linearBlurUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0,strength:.4},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float strength;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            \n            float Linear_ease(in float begin, in float change, in float duration, in float time) {\n                return change * time / duration + begin;\n            }\n            \n            float Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\n                if (time == 0.0)\n                    return begin;\n                else if (time == duration)\n                    return begin + change;\n                time = time / (duration / 2.0);\n                if (time < 1.0)\n                    return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\n                return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\n            }\n            \n            float Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\n                return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\n            }\n            \n            float random(in vec3 scale, in float seed) {\n                return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n            }\n            \n            vec3 crossFade(in vec2 uv1, in vec2 uv2, in float dissolve) {\n                return mix(texture2D(previousTexture, uv1).rgb, texture2D(uSampler, uv2).rgb, dissolve);\n            }\n            \n            void main() {\n            \n                vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\n                float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\n            \n                float strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\n                \n                vec3 color = vec3(0.0);\n                float total = 0.0;\n                vec2 toCenter = center - vTextureCoord;\n        \n                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n            \n                for (float t = 0.0; t <= 40.0; t++) {\n                    float percent = (t + offset) / 40.0;\n                    float weight = 4.0 * (percent - percent * percent);\n                    vec2 p = toCenter * percent * strength;\n                    color += crossFade(vFilterCoord + p, vTextureCoord + p, dissolve) * weight;\n                    total += weight;\n                }\n                gl_FragColor = vec4(color / total, 1.0);\n            }\n        ",e}(p),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),g=function(t){function e(){var n=t.call(this,p.vertexSrc,e.fragmentSrc,e.linearblurUniforms)||this;return n.padding=0,n}return y(e,t),e.prototype.apply=function(e,n,o){var r=new vf.Matrix;this.uniforms.filterMatrix=r,this.uniforms.resolution=vf.settings.RESOLUTION,t.prototype.apply.call(this,e,n,o,vf.CLEAR_MODES.NO)},e.prototype.setPreviousTexture=function(t){this.uniforms.previousTexture=t},e.prototype.setProgress=function(t){t=Math.min(1,t),t=Math.max(0,t),this.uniforms.progress=t},Object.defineProperty(e.prototype,"progress",{get:function(){return this.uniforms.progress},set:function(t){t=Math.min(1,t),t=Math.max(0,t),this.uniforms.progress=t},enumerable:!0,configurable:!0}),e.prototype.applyTranisition=function(t){this.target=t,this.target.filters=[this]},e.prototype.dispose=function(){this.target&&(this.target.filters=[])},e.linearblurUniforms={resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0,barWidth:10,amplitude:2,noise:.1,frequency:1},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            uniform int barWidth;\n            uniform float amplitude;\n            uniform float noise;\n            uniform float frequency;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            float rand(int num) {\n                return fract(mod(float(num) * 67123.313, 12.0) * sin(float(num) * 10.3) * cos(float(num)));\n            }\n            \n            float wave(int num) {\n                float fn = float(num) * frequency * 0.1  * float(barWidth);\n                return cos(fn * 0.5) * cos(fn * 0.13) * sin((fn+10.0) * 0.3) / 2.0 + 0.5;\n            }\n            \n            float pos(int num) {\n                return noise == 0.0 ? wave(num) : mix(wave(num), rand(num), noise);\n            }\n            \n            void main() {\n                int bar = int(vFilterCoord.x) / barWidth;\n                float scale = 1.0 + pos(bar) * amplitude;\n                float phase = progress * scale;\n                float posY = vFilterCoord.y / resolution;\n                vec2 p;\n                vec4 c;\n                if (phase + posY < 1.0) {\n                    p = vec2(vFilterCoord.x, vFilterCoord.y + mix(0.0, resolution, phase)) / resolution;\n                    c = texture2D(previousTexture, p);\n                } else {\n                    p = vTextureCoord.xy / resolution;\n                    c = texture2D(uSampler, p);\n                }\n                gl_FragColor = c;\n            }\n        ",e}(vf.Filter),_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),b=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.linearBlurUniforms)||this}return _(e,t),e.linearBlurUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            bool inHeart (vec2 p, vec2 center, float size) {\n                if (size == 0.0) return false;\n                vec2 o = (p-center)/(1.6*size);\n                return pow(o.x*o.x+o.y*o.y-0.3, 3.0) < o.x*o.x*pow(o.y, 3.0);\n            }\n            \n            void main() {\n                vec2 p1 = vFilterCoord.xy / resolution;\n                vec2 p2 = vTextureCoord.xy / resolution;\n                float m = inHeart(p1, vec2(0.5, 0.4), progress) ? 1.0 : 0.0;\n                gl_FragColor = mix(texture2D(previousTexture, p1), texture2D(uSampler, p2), m);\n            }\n        ",e}(p),T=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),w=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.linearBlurUniforms)||this}return T(e,t),e.linearBlurUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0,intensity:.1},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float intensity;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const int PASSES = 8;\n            \n            void main() {\n                vec2 p1 = vFilterCoord.xy;\n                vec2 p2 = vTextureCoord.xy;\n                vec4 c1 = vec4(0.0), c2 = vec4(0.0);\n                float disp = intensity*(0.5-distance(0.5, progress));\n                for (int xi=0; xi<PASSES; ++xi) {\n                        float x = float(xi) / float(PASSES) - 0.5;\n                    for (int yi=0; yi<PASSES; ++yi) {\n                        float y = float(yi) / float(PASSES) - 0.5;\n                        vec2 v = vec2(x,y);\n                        float d = disp;\n                        c1 += texture2D(previousTexture, p1 + d*v);\n                        c2 += texture2D(uSampler, p2 + d*v);\n                    }\n                }\n                c1 /= float(PASSES*PASSES);\n                c2 /= float(PASSES*PASSES);\n                gl_FragColor = mix(c1, c2, progress);\n            }\n        ",e}(p),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.linearBlurUniforms)||this}return x(e,t),e.linearBlurUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float MIN_AMOUNT = -0.16;\n            const float MAX_AMOUNT = 1.3;\n            float amount = progress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;\n            \n            const float PI = 3.141592653589793;\n            \n            const float scale = 512.0;\n            const float sharpness = 3.0;\n            \n            float cylinderCenter = amount;\n            float cylinderAngle = 2.0 * PI * amount;\n            \n            const float cylinderRadius = 1.0 / PI / 2.0;\n            \n            vec3 hitPoint(float hitAngle, float yc, vec3 point, mat3 rrotation)\n            {\n                float hitPoint = hitAngle / (2.0 * PI);\n                point.y = hitPoint;\n                return rrotation * point;\n            }\n            \n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n            \n            float distanceToEdge(vec3 point)\n            {\n                float dx = abs(point.x > 0.5 ? 1.0 - point.x : point.x);\n                float dy = abs(point.y > 0.5 ? 1.0 - point.y : point.y);\n                if (point.x < 0.0) dx = -point.x;\n                if (point.x > 1.0) dx = point.x - 1.0;\n                if (point.y < 0.0) dy = -point.y;\n                if (point.y > 1.0) dy = point.y - 1.0;\n                if ((point.x < 0.0 || point.x > 1.0) && (point.y < 0.0 || point.y > 1.0)) {\n                    return sqrt(dx * dx + dy * dy);\n                }\n                return min(dx, dy);\n            }\n            \n            vec4 seeThrough(float yc, vec2 p, mat3 rotation, mat3 rrotation)\n            {\n                float hitAngle = PI - (acos(yc / cylinderRadius) - cylinderAngle);\n                vec3 point = hitPoint(hitAngle, yc, rotation * vec3(p, 1.0), rrotation);\n                if (yc <= 0.0 && (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0))\n                {\n                    return texture2D(uSampler, vTextureCoord);\n                }\n            \n                if (yc > 0.0) return texture2D(previousTexture, p);\n            \n                vec4 color = texture2D(previousTexture, point.xy);\n                vec4 tcolor = vec4(0.0);\n            \n                return antiAlias(color, tcolor, distanceToEdge(point));\n            }\n            \n            vec4 seeThroughWithShadow(float yc, vec2 p, vec3 point, mat3 rotation, mat3 rrotation)\n            {\n                float shadow = distanceToEdge(point) * 30.0;\n                shadow = (1.0 - shadow) / 3.0;\n            \n                if (shadow < 0.0) shadow = 0.0; else shadow *= amount;\n            \n                vec4 shadowColor = seeThrough(yc, p, rotation, rrotation);\n                shadowColor.r -= shadow;\n                shadowColor.g -= shadow;\n                shadowColor.b -= shadow;\n            \n                return shadowColor;\n            }\n            \n            vec4 backside(float yc, vec3 point)\n            {\n                vec4 color = texture2D(previousTexture, point.xy);\n                float gray = (color.r + color.b + color.g) / 15.0;\n                gray += (8.0 / 10.0) * (pow(1.0 - abs(yc / cylinderRadius), 2.0 / 10.0) / 2.0 + (5.0 / 10.0));\n                color.rgb = vec3(gray);\n                return color;\n            }\n            \n            vec4 behindSurface(float yc, vec3 point, mat3 rrotation)\n            {\n                float shado = (1.0 - ((-cylinderRadius - yc) / amount * 7.0)) / 6.0;\n                shado *= 1.0 - abs(point.x - 0.5);\n            \n                yc = (-cylinderRadius - cylinderRadius - yc);\n            \n                float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n                point = hitPoint(hitAngle, yc, point, rrotation);\n            \n                if (yc < 0.0 && point.x >= 0.0 && point.y >= 0.0 && \n                    point.x <= 1.0 && point.y <= 1.0 && (hitAngle < PI || amount > 0.5))\n                {\n                    shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / (71.0 / 100.0));\n                    shado *= pow(-yc / cylinderRadius, 3.0);\n                    shado *= 0.5;\n                }\n                else\n                {\n                    shado = 0.0;\n                }\n                return vec4(texture2D(uSampler, vTextureCoord).rgb - shado, 1.0);\n            }\n            \n            void main()\n            {\n                const float angle = 30.0 * PI / 180.0;\n                float c = cos(-angle);\n                float s = sin(-angle);\n            \n                mat3 rotation = mat3( c, s, 0, -s, c, 0, 0.12, 0.258, 1);\n                c = cos(angle);\n                s = sin(angle);\n            \n                mat3 rrotation = mat3(\tc, s, 0, -s, c, 0, 0.15, -0.5, 1);\n            \n                vec3 point = rotation * vec3(vFilterCoord, 1.0);\n            \n                float yc = point.y - cylinderCenter;\n            \n                if (yc < -cylinderRadius)\n                {\n                    gl_FragColor = behindSurface(yc, point, rrotation);\n                    return;\n                }\n            \n                if (yc > cylinderRadius)\n                {\n                    gl_FragColor = texture2D(previousTexture, vFilterCoord);\n                    return;\n                }\n            \n                float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n            \n                float hitAngleMod = mod(hitAngle, 2.0 * PI);\n                if ((hitAngleMod > PI && amount < 0.5) || (hitAngleMod > PI/2.0 && amount < 0.0))\n                {\n                    gl_FragColor = seeThrough(yc, vFilterCoord, rotation, rrotation);\n                    return;\n                }\n            \n                point = hitPoint(hitAngle, yc, point, rrotation);\n            \n                if (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)\n                {\n                    gl_FragColor = seeThroughWithShadow(yc, vFilterCoord, point, rotation, rrotation);\n                    return;\n                }\n            \n                vec4 color = backside(yc, point);\n            \n                vec4 otherColor;\n                if (yc < 0.0)\n                {\n                    float shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / 0.71);\n                    shado *= pow(-yc / cylinderRadius, 3.0);\n                    shado *= 0.5;\n                    otherColor = vec4(0.0, 0.0, 0.0, shado);\n                }\n                else\n                {\n                    otherColor = texture2D(previousTexture, vFilterCoord);\n                }\n            \n                color = antiAlias(color, otherColor, cylinderRadius - abs(yc));\n            \n                vec4 cl = seeThroughWithShadow(yc, vFilterCoord, point, rotation, rrotation);\n                float dist = distanceToEdge(point);\n            \n                gl_FragColor = antiAlias(color, cl, dist);\n            }\n        ",e}(p),O=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),A=function(t){function e(){var n=t.call(this,"",e.fragmentSrc)||this;return n.padding=0,n}return O(e,t),e.fragmentSrc="\n            precision highp float;\n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            \n            void main() {\n                vec4 displacement1 = texture2D( previousTexture, vTextureCoord);\n                vec4 displacement2 = texture2D( uSampler, vFilterCoord);\n                vec4 displacement = mix(displacement1, displacement2, vec4(progress));\n                vec2 mixTexture = mix(displacement.xy, vTextureCoord.xy, vec2(progress));\n                vec2 testPos1 = mixTexture + (1.0 - progress) * displacement.xy * 0.5;\n                vec2 testPos = mix(testPos1, vec2(1.0), vec2(1.0 - progress));\n                vec2 distUv = vec2(testPos.x, vTextureCoord.y);\n                vec4 color = texture2D(uSampler, distUv);\n                vec4 color1 = texture2D(previousTexture, distUv);\n                gl_FragColor = vec4(mix(color, vec4(vec3(color1), 0.0), 0.18));\n            }\n        ",e}(p),P=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),S=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.linearBlurUniforms)||this}return P(e,t),e.linearBlurUniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0,size:.2},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            uniform float size;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            float rand (vec2 co) {\n                return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n            }\n            \n            void main() {\n                float r = rand(vec2(0, vTextureCoord.y));\n                float m = smoothstep(0.0, -size, vTextureCoord.x*(1.0-size) + size*r - (progress * (1.0 + size)));\n                gl_FragColor = mix(texture2D(previousTexture, vFilterCoord), texture2D(uSampler, vTextureCoord), m);\n            }\n        ",e}(p),C=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),k=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.uniforms)||this}return C(e,t),e.uniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            const float MIN_ANGLE = PI / 4.0;\n            const float MAX_ANGLE = PI / 2.0;\n            const float MIN_X = 0.5;\n            const float MAX_X = 0.95;\n            const float sharpness = 3.0;\n            const float scale = 512.0;\n            // float easeProgress = ( pow((progress - 1.0), 3.0) + 1.0 );\n            // float easeProgress = (progress == 1.0) ? 1.0 : -pow(2.0, -10.0 * progress) + 1.0;\n            float p = progress > 0.99 ? 0.99 : progress;\n            float easeProgress =  sqrt(1.0 - pow((p - 1.0), 2.0));\n            float curX = (1.0 - easeProgress) * (MAX_X - MIN_X) + MIN_X;\n            float angle = (easeProgress) * (MAX_ANGLE - MIN_ANGLE) + MIN_ANGLE;\n                     \n            float distanceToLine(vec2 point)\n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                return abs(a * point.x + b * point.y + c) / sqrt(a * a + b * b);\n            }\n\n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n\n            vec2 getMirro(vec2 point ) \n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2;\n            }\n\n            vec4 curPageBack(vec2 point)\n            {\n                vec2 mirror = getMirro(point);\n                vec4 color = texture2D(uSampler, vec2(1.0 - mirror.x, mirror.y));\n                return color;\n            }\n\n            vec4 curPage(vec2 point)\n            {\n                vec4 color = texture2D(previousTexture, point.xy);\n                return color;\n            }\n            vec4 nextPage(vec2 point)\n            {\n                vec4 color = texture2D(uSampler, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, d);\n                if(d < 0.02) {\n                    float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                    return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                };\n                return color;\n            }\n            bool isNextPage(vec2 point) \n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                vec2 p2 = vec2(point.x - p0.x, point.y - p0.y);\n                vec2 p3 = vec2(point.x - p1.x, point.y - p1.y);\n                return p2.x * p3.y - p3.x * p2.y < 0.0;\n            }\n            bool isCurPageBack(vec2 point)\n            {\n                vec2 p0 = vec2(1.0-curX, 1.0);\n                vec2 p1 = vec2(0.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2.x > 0.0 && p2.x < 1.0 && p2.y > 0.0 && p2.y < 1.0;\n            }\n            \n            void main()\n            {\n            \n                vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n                if (isNextPage(vTextureCoord)) {\n                    color = nextPage(vTextureCoord);\n                } else if (isCurPageBack(vTextureCoord)) {\n                    color = curPageBack(vTextureCoord);\n                } else {\n                    color = curPage(vTextureCoord);\n                }\n                gl_FragColor = color;\n            }\n        ",e}(p),M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),I=function(t){function e(){return t.call(this,p.vertexSrc,e.fragmentSrc,e.uniforms)||this}return M(e,t),e.uniforms={filterMatrix:vf.Matrix.TEMP_MATRIX,resolution:vf.settings.RESOLUTION,previousTexture:null,progress:0},e.fragmentSrc="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n            \n            uniform sampler2D uSampler;\n            uniform sampler2D previousTexture;\n            uniform float progress;\n            uniform float resolution;\n            \n            varying vec2 vTextureCoord;\n            varying vec2 vFilterCoord;\n            \n            const float PI = 3.141592653589793;\n            const float MIN_ANGLE = PI / 4.0;\n            const float MAX_ANGLE = PI / 2.0;\n            const float MIN_X = 0.5;\n            const float MAX_X = 0.95;\n            const float sharpness = 3.0;\n            const float scale = 512.0;\n\n            // float easeProgress = ( pow((progress - 1.0), 3.0) + 1.0 );\n            // float easeProgress = (progress == 1.0) ? 1.0 : -pow(2.0, -10.0 * progress) + 1.0;\n            float p = progress > 0.99 ? 0.99 : progress;\n            float easeProgress =  sqrt(1.0 - pow((p - 1.0), 2.0));\n            float curX = (1.0 - easeProgress) * (MAX_X - MIN_X) + MIN_X;\n            float angle = (easeProgress) * (MAX_ANGLE - MIN_ANGLE) + MIN_ANGLE;\n                     \n            float distanceToLine(vec2 point)\n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                return abs(a * point.x + b * point.y + c) / sqrt(a * a + b * b);\n            }\n\n            vec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n            {\n                distanc *= scale;\n                if (distanc < 0.0) return color2;\n                if (distanc > 2.0) return color1;\n                float dd = pow(1.0 - distanc / 2.0, sharpness);\n                return ((color2 - color1) * dd) + color1;\n            }\n\n            vec2 getMirro(vec2 point ) \n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2;\n            }\n\n            vec4 curPageBack(vec2 point)\n            {\n                vec2 mirror = getMirro(point);\n                vec4 color = texture2D(uSampler, vec2(1.0 - mirror.x, mirror.y));\n                return color;\n            }\n\n            vec4 curPage(vec2 point)\n            {\n                vec4 color = texture2D(previousTexture, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, 1.0);\n                // return shadow;\n                // if(d < 0.2) {\n                //     float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                //     return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                // };\n                return color;\n            }\n            vec4 nextPage(vec2 point)\n            {\n                vec4 color = texture2D(uSampler, point);\n                float d = distanceToLine(point);\n                vec4 shadow = vec4(1.0, 0.0, 0.0, d);\n                if(d < 0.02) {\n                    float c = (0.1 - (0.02 - d)) * (10.0 + progress * 1.5);\n                    return vec4(color.r * c, color.g * c, color.b * c, 1.0);\n                };\n                return color;\n            }\n            bool isNextPage(vec2 point) \n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                vec2 p2 = vec2(point.x - p0.x, point.y - p0.y);\n                vec2 p3 = vec2(point.x - p1.x, point.y - p1.y);\n                return p2.x * p3.y - p3.x * p2.y > 0.0;\n            }\n            bool isCurPageBack(vec2 point)\n            {\n                vec2 p0 = vec2(curX, 1.0);\n                vec2 p1 = vec2(1.0, -(1.0 - curX) * tan(angle) + 1.0);\n                float a = p1.y - p0.y;\n                float b = p0.x - p1.x;\n                float c = p1.x * p0.y - p0.x * p1.y;\n                float k = -2.0 * (a * point.x + b * point.y + c) / (a * a + b * b);\n                vec2 p2 = vec2(point.x + k * a, point.y + k * b);\n                return p2.x > 0.0 && p2.x < 1.0 && p2.y > 0.0 && p2.y < 1.0;\n            }\n            \n            \n            void main()\n            {\n            \n                vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n                if (isNextPage(vTextureCoord)) {\n                    color = nextPage(vTextureCoord);\n                } else if (isCurPageBack(vTextureCoord)) {\n                    color = curPageBack(vTextureCoord);\n                } else {\n                    color = curPage(vTextureCoord);\n                }\n                gl_FragColor = color;\n            }\n        ",e}(p),L=function(){function t(){this._progress=0}return Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress},set:function(t){this._progress=t,this.prevSprite&&(this.prevSprite.alpha=1-this._progress)},enumerable:!0,configurable:!0}),t.prototype.setPreviousTexture=function(t){this.prevTexture=t,this.prevTexture&&(this.prevSprite=vf.Sprite.from(this.prevTexture))},t.prototype.applyTranisition=function(t){this.target=t,this.target&&this.target.parent&&this.prevSprite&&(this.prevSprite.x=this.target.x,this.prevSprite.y=this.target.y,this.target.parent.addChild(this.prevSprite))},t.prototype.dispose=function(){var t;this.prevSprite&&this.prevSprite.parent&&(this.prevSprite.parent.removeChild(this.prevSprite),null===(t=this.prevTexture)||void 0===t||t.destroy(),this.prevTexture=void 0,this.prevSprite=void 0)},t}(),R=function(){function t(t,e,n){this.vfStage=t,this.prevTexture=e,this.data=n}return t.prototype.run=function(){var t=this.getTransition(this.data.type);if(t){var e=this.vfStage.systemEvent;t.setPreviousTexture(this.prevTexture),t.progress=0,t.applyTranisition(this.vfStage.container);var n=this.vfStage.tween;n.setObject(t),n.once(vf.gui.Tween.Event.complete,(function(){t.dispose(),e.emit("status",{code:"TransitionEnd",level:"status",data:null})})),n.to({progress:1},this.data.duration).start(),e.emit("status",{code:"TransitionStart",level:"status",data:null})}},t.prototype.getTransition=function(t){var e;if(this.vfStage&&(1!==this.vfStage.scaleX||1!==this.vfStage.scaleY||!(null===(e=this.vfStage.app)||void 0===e?void 0:e.renderer.context).webGLVersion))return new L;switch(t){case"none":return null;case"fadeOut":return new h;case"circleWipe":return new d;case"crossZoom":return new m;case"doomScreen":return new g;case"heartWipe":return new b;case"linearBlur":return new w;case"pageCurl":return new E;case"toTear":return new A;case"wind":return new S;case"pageFlipLeft":return new k;case"pageFlipRight":return new I;default:return null}return null},t}();function N(t,e){for(var n=t;e.length>0;){var o=e.shift();if(!(n&&n instanceof c&&o))return;n=n.getChildById(o)}return n}function j(t,e){if(t&&Array.isArray(e)&&e.length>1&&(e[0]===o.VARIABLE||e[0]===o.PROPERTY||e[0]===o.ARRAY_VALUE||e[0]===o.PARAM_VALUE||e[0]===o.OBJECT_VALUE||e[0]===o.COMPONENT)){var n=t.vfStage;if(n&&n.variableManager){var r=n.variableManager.getExpressItemValue(t,e);if(r&&r instanceof vf.gui.DisplayObject)return r}}return function(t,e){if(e){if(e.length<=0)return t;var n=e.concat();return"-1"===n[0]?function(t,e){if(e.shift(),t.vfStage){var n,o=t.vfStage.getCurScene(),r=e.shift();if(o){for(var i=0,a=o.uiChildren.length;i<a&&!((n=o.uiChildren[i])instanceof c&&n.id===r);i++);if(void 0!==n)return N(n,e)}}}(t,n):N(t,n)}return t}(t,e)}function D(t){return"number"==typeof t&&!isNaN(t)}var V,F=function(){function t(){this.variableConfig={},this.variableMap={},this.runFunctionId=0,this.functionMap={}}return t.prototype.shuffle=function(t){for(var e=t.length-1;e>=0;e--){var n=Math.floor(Math.random()*(e+1)),o=t[n];t[n]=t[e],t[e]=o}},t.prototype.clear=function(){this.variableMap={},this.functionMap={}},t.prototype.getFunctionId=function(){return++this.runFunctionId},t.prototype.getFunctionTask=function(t){return this.functionMap[t]},t.prototype.setFunctionTask=function(t,e){this.functionMap[t]=e},t.prototype.addVariableConfig=function(t,e){if(!this.variableConfig[t]){var n=this.normalizeVariableConfig(e);this.variableConfig[t]=n}},t.prototype.normalizeVariableConfig=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e],o=this.createIVariableData(e,n);t[e]=o}return t},t.prototype.addVariableToGlobal=function(e){var n=t.GLOBAL_ID;if(this.variableMap[n]=this.deepCopy(e),this.variableConfig[n]){var o=this.variableConfig[n];this.variableMap[n]=this.deepCopy(o)}else if(this.addVariableConfig(n,e),this.variableConfig[n]){o=this.variableConfig[n];this.variableMap[n]=this.deepCopy(o)}},t.prototype.addVariableToComponent=function(t){var e=t.libId;if(e&&this.variableConfig[e.toString()]){var n=this.variableConfig[e.toString()];this.variableMap[t.id.toString()]=this.deepCopy(n)}},t.prototype.addVariableDataToComponent=function(t,e,n,o){var r=t.libId,i=t.id;this.addVariable(r,i,e,n,o)},t.prototype.addVariableDataToGlobal=function(e,n,o){this.addVariable(t.GLOBAL_ID,t.GLOBAL_ID,e,n,o)},t.prototype.addVariable=function(t,e,n,o,r){var i={id:n,type:o,value:r},a={id:n,type:o,value:r},s=this.variableConfig[t];s||(s={},this.variableConfig[t]=s),s[n]=i;var c=this.variableMap[e];c||(c={},this.variableMap[e]=c),c[n]=a},t.prototype.getGlobalVariable=function(e){return this.getVariable(t.GLOBAL_ID,e)},t.prototype.getVariable=function(t,e){var n=this.variableMap[t];if(n&&n[e])return n[e]},t.prototype.getVariableByData=function(e,n){if(n[0]===o.PARAM_VALUE)return this.getVariable(t.GLOBAL_ID,n[2]);var r=j(e,n[1]),i=r?r.id.toString():t.GLOBAL_ID;return this.getVariable(i,n[2])},t.prototype.caculateExpress=function(e,n){for(var r=[],i=[],a=0,s=n.length;a<s;a++){var c=n[a];switch(c[0]){case o.CONST:case o.VARIABLE:case o.STSTEN:case o.RANDOM:case o.PROPERTY:case o.ARRAY_LEN:case o.ARRAY_VALUE:case o.OBJECT_VALUE:case o.PARAM_VALUE:case o.ARRAY_FUNCTION:case o.COMPONENT:r.push(c);break;case o.OPERATION:switch(c[1]){case"(":i.push(c);break;case")":for(var u=i.pop();u&&"("!==u[1];)r.push(u),u=i.pop();break;default:var p=c[1],l=t.OPERATE_PRIORITY[p];if(!l)return this.emitError(e,"E1001",[p],"warning"),0;if(i.length>0){var h=i[i.length-1],f=t.OPERATE_PRIORITY[h[1]];if(l>f)i.push(c);else{for(;l<=f&&(r.push(h),i.pop(),i.length>0);)h=i[i.length-1],f=t.OPERATE_PRIORITY[h[1]];i.push(c)}}else i.push(c)}}}if(i.length>0)for(;i.length>0;){(p=i.pop())&&r.push(p)}return this.caculateExpressValue(e,r)},t.prototype.getExpressItemValue=function(t,e){var n;switch(e[0]){case o.CONST:n=e[1];break;case o.VARIABLE:var i=this.getVariableByData(t,e);i?n=i.value:this.emitError(t,"E1002",[e.join(",")],"warning");break;case o.STSTEN:var a=new Date,s=0;switch(e[1]){case r.TIME:s=a.getTime();break;case r.YEAR:s=a.getFullYear();break;case r.MONTH:s=a.getMonth();break;case r.DAY:s=a.getDay();break;case r.DATE:s=a.getDate()}n=s;break;case o.RANDOM:var c=0;if(e.length>=3){var u=e[1],p=e[2];c=Math.round(Math.random()*(p-u))+u}else c=Math.random();n=c;break;case o.COMPONENT:n=j(t,e[1]);break;case o.PROPERTY:var l=j(t,e[1]);if(l&&e.length>=3){for(var h=2,f=e.length;h<f;h++){var d=e[h];l&&void 0!==d&&(l=l[d])}n=l}else n=void 0;break;case o.ARRAY_LEN:var v=this.getVariableByData(t,e);v?n=v.value.length:this.emitError(t,"E1002",[e.join(",")],"warning");break;case o.ARRAY_VALUE:var m=this.getVariableByData(t,e);if(m){var y=m.value,g=e[3];if(Array.isArray(g)){var _=this.getExpressItemValue(t,g);D(_)?g=_:(this.emitError(t,"E1003",[g],"warning"),g=0)}n=y[g],e.length>=5&&n&&(n=n[e[4]])}else this.emitError(t,"E1002",[e.join(",")],"warning");break;case o.ARRAY_FUNCTION:var b=this.getVariableByData(t,e);if(b)if(Array.isArray(b.value)){var T=b.value;switch(e[3]){case"pop":n=T.pop();break;case"push":if(e.length>4){var w=this.getExpressItemValue(t,e[4]);n=T.push(w)}break;case"shift":n=T.shift();break;case"unshift":if(e.length>4){var x=this.getExpressItemValue(t,e[4]);n=T.unshift(x)}break;case"concat":if(e.length>3)if(e.length>4){var E=this.getExpressItemValue(t,e[4]);n=T.concat(E)}else n=T.concat();break;case"splice":if(5===e.length){var O=this.getExpressItemValue(t,e[4]);n=T.splice(O)}else if(6===e.length){O=this.getExpressItemValue(t,e[4]);var A=this.getExpressItemValue(t,e[5]);n=T.splice(O,A)}else if(e.length>6){O=this.getExpressItemValue(t,e[4]),A=this.getExpressItemValue(t,e[5]);var P=this.getExpressItemValue(t,e[6]);n=T.splice(O,A,P)}break;default:this.emitError(t,"E1004",[e[3]],"warning")}}else this.emitError(t,"E1005",[e.join(",")],"warning");else this.emitError(t,"E1002",[e.join(",")],"warning");break;case o.OBJECT_VALUE:case o.PARAM_VALUE:var S=this.getVariableByData(t,e);if(S){var C=S.value;for(h=3,f=e.length;h<f;h++){d=e[h];C&&void 0!==d&&(C=C[d])}n=C}}return n},t.prototype.caculateExpressValue=function(t,e){var n=[];if(1===e.length)return this.getExpressItemValue(t,e[0]);for(var r=0,i=e.length;r<i;r++){var a=e[r];switch(a[0]){case o.OPERATION:var s=void 0,c=void 0;"!"===a[1]?s=n.pop():(c=n.pop(),s=n.pop());var u=this.caculateOneExpress(t,a[1],s,c);n.push(u);break;default:n.push(a)}}return 1===n.length?n[0][1]:(this.emitError(t,"E1006",void 0,"warning"),0)},t.prototype.caculateOneExpress=function(t,e,n,r){var i,a,s,c=[o.CONST,0];switch(n&&(i=this.getExpressItemValue(t,n)),r&&(a=this.getExpressItemValue(t,r)),e){case"*":s=i*a;break;case"/":s=i/a;break;case"%":s=i%a;break;case"+":s=i+a;break;case"-":s=i-a;break;case">=":s=i>=a;break;case"<=":s=i<=a;break;case">":s=i>a;break;case"<":s=i<a;break;case"==":s=i==a;break;case"===":s=i===a;break;case"!=":s=i!=a;case"!==":s=i!==a;break;case"!":s=!i;break;case"&&":s=i&&a;break;case"||":s=i||a;break;case"=":if(s=a,n)switch(n[0]){case o.VARIABLE:var u=this.getVariableByData(t,n);u?u.value=s:this.emitError(t,"E1002",[n.join(",")],"warning");break;case o.PROPERTY:var p=n[1],l=n[2],h=j(t,p);if(h&&n.length>=3){for(var f=h,d=l,v=2,m=n.length;v<m&&(d=n[v],v!==m-1);v++)f?f=f[d]:this.emitError(t,"E1007",[n.join(",")],"warning");f&&d?f[d]=s:this.emitError(t,"E1007",[n.join(",")],"warning")}break;case o.ARRAY_LEN:var y=this.getVariableByData(t,n);y?y.value.length=s:this.emitError(t,"E1002",[n.join(",")],"warning");break;case o.ARRAY_VALUE:var g=this.getVariableByData(t,n);if(g){var _=g.value,b=n[3]||0;if(Array.isArray(b)){var T=this.getExpressItemValue(t,b);D(T)?b=T:(this.emitError(t,"E1003",[b],"warning"),b=0)}if(n.length>=5){var w=_[b],x=void 0;for(v=4,m=n.length;v<m;v++)x=n[v],v<m-1&&w[x]&&(w=w[x]);w&&void 0!==x&&(w[x]=s)}else _[b]=s}else this.emitError(t,"E1002",[n.join(",")],"warning");break;case o.OBJECT_VALUE:case o.PARAM_VALUE:var E=this.getVariableByData(t,n);if(E){for(w=E.value,x=void 0,v=3,m=n.length;v<m;v++)x=n[v],v<m-1&&w[x]&&(w=w[x]);w&&void 0!==x?w[x]=s:E.value=s}break;case o.CONST:this.emitError(t,"E1008",[n.join(",")],"warning")}break;default:this.emitError(t,"E1001",[e],"warning")}return c[1]=s,c},t.prototype.deepCopy=function(t){var e=JSON.stringify(t);return JSON.parse(e)},t.prototype.isIVariableData=function(t){return e=t,!("[object Object]"!==Object.prototype.toString.call(e)||!t.hasOwnProperty("type")||!t.hasOwnProperty("value")||"array"!==t.type&&"boolean"!==t.type&&"number"!==t.type&&"object"!==t.type&&"string"!==t.type);var e},t.prototype.createIVariableData=function(t,e){if(this.isIVariableData(e))return e;var n={id:t,type:"object",value:e};return"boolean"==typeof e?n.type="boolean":!function(t){return"string"==typeof t}(e)?D(e)?n.type="string":!function(t){return Array.isArray(t)}(e)?n.type="object":n.type="array":n.type="string",n},t.prototype.emitError=function(t,e,n,o){var r;if(void 0===o&&(o="error"),!t||!t.vfStage)throw new Error(e+": "+(null===(r=n)||void 0===r?void 0:r.join(" ")));t.vfStage.systemEvent.emitError(e,n,o)},t.GLOBAL_ID="global",t.OPERATE_PRIORITY={"*":100,"/":100,"%":98,"+":97,"-":97,">=":95,"<=":94,">":93,"<":92,"==":91,"===":91,"!=":90,"!==":90,"!":89,"&&":88,"||":87,"=":86},t}(),B=function(){function t(t,e){this.trackIdMap=[],this.res=t,this.stage=e}return t.prototype.getAudio=function(t){var e=vf.AudioEngine.Ins();if(void 0!==t)return e.map.get(this.stage.config.uuid.toString()+t)},t.prototype.clear=function(){this.pause();for(var t,e=this.trackIdMap;e.length>0;)(t=this.getAudio(e.shift()))&&t.dispose()},t.prototype.pause=function(){var t,e=this;this.trackIdMap.forEach((function(n){(t=e.getAudio(n))&&t.pause()}))},t.prototype.resume=function(){var t,e=this;this.trackIdMap.forEach((function(n){(t=e.getAudio(n))&&t.play()}))},t.prototype.pauseSound=function(t){if(void 0===t&&(t={}),!this.nativeEmit(t.assetId,"pauseAudio",t)&&!this.weixinEmit()){var e=this.getAudio(t.trackId);e&&e.pause()}},t.prototype.resumeSound=function(t){if(!this.nativeEmit(t.assetId,"resumeAudio",t)&&!this.weixinEmit()){var e=this.getAudio(t.trackId);e&&e.paused&&e.play()}},t.prototype.playSound=function(t){var e=this.res.data.assets[t.assetId.toString()];if(void 0!==e&&void 0!==e.url&&""!==e.url){if(!this.nativeEmit(t.assetId,"playAudio",t)&&!this.weixinEmit()){var n=this.getAudio(t.trackId);n?n.play(0,0):((n=vf.AudioEngine.Ins().createAudio(this.stage.config.uuid.toString()+t.trackId,e.url,{autoplay:!1})).play(t.time,t.offset,t.length),this.trackIdMap.push(t.trackId))}}else console.warn("playback failed,missing assetId!",t)},t.prototype.isWeixin=function(){var t=window.navigator.userAgent.toLowerCase();return/micromessenger/.test(t)},t.prototype.weixinEmit=function(){return!1},t.prototype.nativeEmit=function(t,e,n){if(void 0===n&&(n={}),this.stage.config.vfvars.useNativeAudio){var o=this.res.getAsset(t);return this.stage.systemEvent.emit("message",{code:"native",type:"native",level:"command",data:{type:e,id:n.trackId||0,src:o.url,mode:n.mode||"sound"}}),!0}return!1},t}(),U=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),G=function(t){function e(e){var n=t.call(this)||this;return n.id="-1",n.component=null,n.vfStage=e,n}return U(e,t),e.prototype.pause=function(){this.component&&this.component.pause()},e.prototype.resume=function(){this.component&&this.component.resume()},e.prototype.addComponent=function(t){this.component=t,this.component.vfStage=this.vfStage,this.component.runAction(),this.component.emitAddToChildBefore();this.addChild(t);this.component.emitAddToChild(),this.component.playDefaultAnimation()},e.prototype.removeComponent=function(){if(this.component){this.component.emitRemoveToChildBefore();this.removeChild(this.component);this.component.emitRemoveToChild(),this.component.stop(),this.component.vfStage=void 0}},e.prototype.dispose=function(){this.component&&(this.removeComponent(),this.component.dispose()),this.component=null},e}(vf.gui.Container),X=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){t.EVENT_COMPLETE="EVENT_COMPLETE",t.EVENT_FAIL="EVENT_FAIL",t.EVENT_BREAK="EVENT_BREAK",t.FUNCTION_RUN_COMPLETE="FUNCTION_RUN_COMPLETE"}(V||(V={}));var Y=function(t){function e(){var e=t.call(this)||this;return e._isRunning=!1,e._isPaused=!1,e._isCompleted=!1,e._isFailed=!1,e._asynchronous=!1,e}return X(e,t),e.prototype.run=function(){this._isRunning=!0,this._isCompleted=!1,this._isFailed=!1},e.prototype.stop=function(){this._isRunning=!1},e.prototype.pause=function(){this._isPaused=!0},e.prototype.resume=function(){this._isPaused=!1},e.prototype.break=function(){this._isRunning=!1,this.emit(V.EVENT_BREAK)},e.prototype.complete=function(){this._isRunning=!1,this._isCompleted=!0,this.emit(V.EVENT_COMPLETE)},e.prototype.fail=function(t,e){void 0===e&&(e=null),this._isRunning=!1,this._isFailed=!0,this.emit(V.EVENT_FAIL,e)},Object.defineProperty(e.prototype,"asynchronous",{get:function(){return this._asynchronous},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCompleted",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFailed",{get:function(){return this._isFailed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},enumerable:!0,configurable:!0}),e}(vf.utils.EventEmitter),H=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),z=function(t){function e(){var e=t.call(this)||this;return e._tasks=[],e._currentTask=null,e._curTaskIndex=0,e}return H(e,t),Object.defineProperty(e.prototype,"tasks",{get:function(){return this._tasks},enumerable:!0,configurable:!0}),e.prototype.run=function(){this.isRunning||(this._curTaskIndex=0,t.prototype.run.call(this),this._nextTask())},e.prototype.stop=function(){t.prototype.stop.call(this),this._currentTask&&(this.clearEvent(this._currentTask),this._currentTask.stop(),this._currentTask=null),this._curTaskIndex=Number.MAX_VALUE,this.off(V.EVENT_COMPLETE),this.off(V.EVENT_BREAK),this.off(V.EVENT_FAIL),this.complete()},e.prototype.pause=function(){if(t.prototype.pause.call(this),this._tasks)for(var e=0,n=this._tasks.length;e<n;e++)this._tasks[e].pause()},e.prototype.resume=function(){if(t.prototype.resume.call(this),this._tasks)for(var e=0,n=this._tasks.length;e<n;e++)this._tasks[e].resume()},e.prototype.break=function(){t.prototype.break.call(this),this._currentTask&&(this.clearEvent(this._currentTask),this._currentTask.break(),this._currentTask=null),this._curTaskIndex=Number.MAX_VALUE,this.off(V.EVENT_COMPLETE),this.off(V.EVENT_BREAK),this.off(V.EVENT_FAIL),this.complete()},e.prototype.addTask=function(t){if(!t)throw new Error("ArgumentError");if(t.asynchronous&&(this._asynchronous=!0),!(this._tasks.indexOf(t)<0))throw new Error("duplicate task");return this._tasks.push(t),t},e.prototype._nextTask=function(t){var e=null;this._curTaskIndex<this._tasks.length&&(e=this._tasks[this._curTaskIndex]),e?(this._currentTask=e,this._currentTask.on(V.EVENT_COMPLETE,this.onOneTaskComplete,this),this._currentTask.on(V.EVENT_FAIL,this.onOneTaskFail,this),this._currentTask.on(V.EVENT_BREAK,this.onOneTaskBreak,this),this._currentTask.run()):this.complete()},e.prototype.clearEvent=function(t){t&&(t.off(V.EVENT_COMPLETE,this.onOneTaskComplete,this),t.off(V.EVENT_FAIL,this.onOneTaskFail,this),t.off(V.EVENT_BREAK,this.onOneTaskBreak,this))},e.prototype.onOneTaskBreak=function(t){this._currentTask&&(this.clearEvent(this._currentTask),this.emit(V.EVENT_BREAK),this.complete())},e.prototype.onOneTaskFail=function(t){if(!this._currentTask)throw new Error("no task");this.clearEvent(this._currentTask),this.fail(t.type,t.data)},e.prototype.onOneTaskComplete=function(t){this.clearEvent(this._currentTask),this._curTaskIndex++,this._nextTask(this._currentTask)},e}(Y),W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),J=function(t){function e(){var e=t.call(this)||this;return e.loopTask=new z,e.loopTask.on(V.EVENT_BREAK,e.onBreak,e),e}return W(e,t),e.prototype.addSubTask=function(t){this.loopTask&&(this.loopTask.addTask(t),this.loopTask.asynchronous&&(this._asynchronous=!0))},e.prototype.stop=function(){t.prototype.stop.call(this),this.loopTask&&(this.loopTask.off(V.EVENT_BREAK),this.loopTask.stop())},e.prototype.break=function(){t.prototype.break.call(this),this.loopTask&&(this.loopTask.off(V.EVENT_BREAK),this.loopTask.break())},e.prototype.pause=function(){t.prototype.pause.call(this),this.loopTask&&this.loopTask.pause()},e.prototype.resume=function(){t.prototype.resume.call(this),this.loopTask&&this.loopTask.resume()},e.prototype.onBreak=function(t){this.break()},e}(Y),q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),K=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o._loopComplete=!1,o.data=n,o.eventName=n.event,o.system=!0===n.system,o.global=!0===n.global,o}return q(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this._loopComplete=!0,this.component)if(this.loopTask&&this.loopTask.on(V.EVENT_COMPLETE,this.onLoopComplete,this),this.system)(e=this.component.vfStage)&&e.systemEvent.on(this.eventName,this.onTriger,this);else if(this.global){var e;(e=this.component.vfStage)&&e.on(this.eventName,this.onTriger,this)}else this._component=j(this.component,this.data.target),this._component&&this._component.on(this.eventName,this.onTriger,this);this.complete()},e.prototype.stop=function(){if(this.complete(),this._component)if(this.system)(e=this._component.vfStage)&&e.systemEvent.off(this.eventName,this.onTriger,this);else if(this.global){var e;(e=this._component.vfStage)&&e.off(this.eventName,this.onTriger,this)}else this._component.off(this.eventName,this.onTriger,this);this.loopTask&&(this.loopTask.off(V.EVENT_COMPLETE,this.onLoopComplete),this.loopTask.complete()),t.prototype.stop.call(this)},e.prototype.break=function(){this.complete(),t.prototype.break.call(this)},e.prototype.onLoopComplete=function(){this._loopComplete=!0},e.prototype.onSystemTriger=function(t){t.code===this.eventName&&this.onTriger()},e.prototype.onTriger=function(){this._isPaused||this.loopTask&&this._loopComplete&&(this._loopComplete=!1,this.loopTask.run())},e}(J),Z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Q=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Z(e,t),e.prototype.run=function(){t.prototype.run.call(this);var e=j(this.component,this.data.target);e&&(e[this.data.property]=this.getValue()),this.complete()},e.prototype.getValue=function(){if(Array.isArray(this.data.value)&&this.component.vfStage)return this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.value);return this.data.value},e}(Y),$=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),tt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return $(e,t),e.prototype.run=function(){(t.prototype.run.call(this),this.component&&this.component.vfStage)&&this.component.vfStage.variableManager.caculateExpress(this.component,this.data.express);this.complete()},e}(Y),et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nt=function(t){function e(e){var n=t.call(this)||this;return n.conditions=[],n.conditionsRun=[],n.component=e,n}return et(e,t),e.prototype.addCondition=function(t,e){t&&t.length?(this.conditions.push(t),this.conditionsRun.push(e)):this.addElse(e)},e.prototype.addElse=function(t){this.elseRun=t},e.prototype.run=function(){t.prototype.run.call(this),this.curRun=this.findTask(),this.curRun?(this.curRun.on(V.EVENT_COMPLETE,this.onTaskComplete,this),this.curRun.on(V.EVENT_BREAK,this.onTaskBreak,this),this.curRun.run()):this.complete()},e.prototype.findTask=function(){if(this.component.vfStage){for(var t=this.component.vfStage.variableManager,e=0,n=this.conditions.length;e<n;e++){var o=this.conditions[e];if(t.caculateExpress(this.component,o))return this.conditionsRun[e]}if(this.elseRun)return this.elseRun}},e.prototype.onTaskComplete=function(t){this.curRun&&this.curRun.off(V.EVENT_COMPLETE,this.onTaskComplete,this),this.complete()},e.prototype.onTaskBreak=function(t){this.break(),this.complete()},e}(Y),ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rt=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.funId="",i.component=e,i.funName=n,i.fun=r,i.data=o,i}return ot(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage){var e=this.component.vfStage.variableManager,n=this.funName,o=j(this.component,this.data.target);o&&(n=o.hashCode+this.funName),e.setFunctionTask(n,this.fun),this.complete()}else this.complete()},e.prototype.stop=function(){t.prototype.stop.call(this)},e}(Y),it=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),at=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return it(e,t),e.prototype.run=function(){t.prototype.run.call(this),this._component=j(this.component,this.data.target);var e=this.getValue(),n=this.getTimes();this._component&&this._component.vfStage&&this._component.play(e,n),this.complete()},e.prototype.getValue=function(){if(Array.isArray(this.data.name)&&(this._component&&this.component.vfStage))return this.component.vfStage.variableManager.getExpressItemValue(this._component,this.data.name);return this.data.name},e.prototype.getTimes=function(){if(Array.isArray(this.data.times)&&(this._component&&this.component.vfStage))return this.component.vfStage.variableManager.getExpressItemValue(this._component,this.data.times);return this.data.times},e}(Y),st=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ct=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.dataType=n.type,o.data=n,o}return st(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage){var e=this.component.vfStage.soundManager,n=this.component.vfStage.variableManager,o=void 0;try{o=n.getExpressItemValue(this.component,this.data.value)}catch(t){vf.utils.deprecation("5.2.1-v14","Please use the new sound API")}if(void 0===o.assetId)return void console.log("execute sound failed, missing assetId");if(void 0===o.trackId)return void console.log("execute sound failed, missing trackId");o.mode=o.mode||"sound";var r=void 0;if(Array.isArray(o.assetId)){var i=n.getExpressItemValue(this.component,o.assetId);r=i&&void 0!==i.value?i.value:i}else r=o.assetId;switch(o.assetId=r,this.dataType){case 16:e.playSound(o);break;case 33:e.pauseSound(o);break;case 34:e.resumeSound(o)}this.complete()}else this.complete()},e}(Y),ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),pt=function(t){function e(e,n,o){var r=t.call(this)||this;return r.runId=-1,r.paramIds=[],r.component=e,r.funName=n,r.data=o,r}return ut(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this._component=j(this.component,this.data.target),this._component instanceof c&&this._component&&this._component.vfStage){var e=this._component.vfStage.variableManager,n=this.funName;if(this.runId=e.getFunctionId(),n=this._component.hashCode+this.funName,this.paramIds.length=0,this.data.params){for(var o=[],r=0,i=this.data.params.length;r<i;r++){var a=h=this.data.params[r];if(Array.isArray(h))a=e.getExpressItemValue(this.component,h);o.push(a)}for(r=0,i=o.length;r<i;r++){var s=n+this.runId+"param_"+r;this.paramIds.push(s),e.variableMap[F.GLOBAL_ID]||(e.variableMap[F.GLOBAL_ID]={}),e.variableMap[F.GLOBAL_ID][s]={id:s,type:"object",value:o[r]}}}this.fun=e.getFunctionTask(n),this.fun?(this.paramIds.length&&this.fun.injectParams(this.paramIds),this.fun.on(V.FUNCTION_RUN_COMPLETE,this.onRunComplete,this),this.fun.runWithId(this.runId)):this.complete()}else{if(this.component.vfStage){e=this.component.vfStage.variableManager;var u=this._component,p=this.data.name;Array.isArray(p)&&(p=e.getExpressItemValue(this.component,p));var l=[];if(this.data.params)for(r=0,i=this.data.params.length;r<i;r++){var h=e.getExpressItemValue(this.component,this.data.params[r]);l.push(h)}u&&p&&u[p]&&u[p].apply(u,l)}this.complete()}},e.prototype.stop=function(){t.prototype.stop.call(this),this.fun&&this.fun.stopWithId(this.runId),this.complete()},e.prototype.break=function(){t.prototype.break.call(this),this.fun&&this.fun.breakWithId(this.runId),this.complete()},e.prototype.complete=function(){if(this.runId=0,this.fun&&this.fun.off(V.FUNCTION_RUN_COMPLETE,this.onRunComplete,this),this.paramIds.length&&this.component&&this.component.vfStage)for(var e=this.component.vfStage.variableManager,n=0,o=this.paramIds.length;n<o;n++){var r=this.paramIds[n];delete e.variableMap[F.GLOBAL_ID][r]}t.prototype.complete.call(this)},e.prototype.onRunComplete=function(t){t===this.runId&&this.complete()},e}(Y);var lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ht=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return lt(e,t),e.prototype.run=function(){var t;(null===(t=this.component.vfStage)||void 0===t?void 0:t.config.debug)&&function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="[VF LOG]";switch(t.length){case 1:return console.log(n,t[0]);case 2:return console.log(n,t[0],t[1]);case 3:return console.log(n,t[0],t[1],t[2]);case 4:return console.log(n,t[0],t[1],t[2],t[3]);case 5:return console.log(n,t[0],t[1],t[2],t[3],t[4]);case 6:console.log(n,t[0],t[1],t[2],t[3],t[4],t[5])}}(this.getValue()),this.complete()},e.prototype.getValue=function(){if(Array.isArray(this.data.value)&&this.component.vfStage)return this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.value);return this.data.value},e}(Y),ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dt=function(t){function e(e,n){var o=t.call(this)||this;return o._totalTimes=0,o._curTimes=0,o._paramId="",o._paramIds=[],o.component=e,o.data=n,o}return ft(e,t),e.prototype.run=function(){t.prototype.run.call(this),this._totalTimes=this.getforin(),this._curTimes=-1,this.loopTask&&(this.loopTask.on(V.EVENT_COMPLETE,this.onLoopComplete,this),this.loopTask.on(V.EVENT_FAIL,this.onLoopComplete,this)),this.addParams(),this.runFor()},e.prototype.break=function(){this._isRunning=!1,this.loopTask&&this.loopTask.stop(),this.complete()},e.prototype.complete=function(){this.removeParams(),t.prototype.complete.call(this)},e.prototype.injectParams=function(t){t&&t.length&&(this._paramIds=t)},e.prototype.runFor=function(){if(this._totalTimes>0&&this._curTimes<this._totalTimes-1)if(this.loopTask){if(this._curTimes++,this.component&&this.component.vfStage){var t=this.component.vfStage.variableManager.getGlobalVariable(this._paramId);t&&(t.value=this._curTimes)}this.loopTask.run()}else this.complete();else this.complete()},e.prototype.getforin=function(){if(this.component.vfStage){var t=this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.forin);return Array.isArray(t)?t.length:parseInt(t,10)}return 0},e.prototype.onLoopComplete=function(){this.runFor()},e.prototype.addParams=function(){if(this.component&&this.component.vfStage){var t=this.component.vfStage.variableManager,e=t.getFunctionId()+"_for";if(this._paramId=e,t.variableMap[F.GLOBAL_ID]||(t.variableMap[F.GLOBAL_ID]={}),t.variableMap[F.GLOBAL_ID][e]={id:e,type:"object",value:0},this.loopTask){var n=this._paramIds.concat([this._paramId]);xt(this.loopTask,n)}}},e.prototype.removeParams=function(){if(this.component&&this.component.vfStage){var t=this.component.vfStage.variableManager,e=this._paramId;delete t.variableMap[F.GLOBAL_ID][e]}},e}(J),vt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return vt(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return j(this.component,this.data.target)},enumerable:!0,configurable:!0}),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage){var e=this.component.vfStage.variableManager,n=this.target,o=this.data.name;Array.isArray(o)&&(o=e.getExpressItemValue(this.component,o));var r=[];if(this.data.params)for(var i=0,a=this.data.params.length;i<a;i++){var s=e.getExpressItemValue(this.component,this.data.params[i]);r.push(s)}n&&o&&n[o]&&n[o].apply(n,r)}this.complete()},e}(Y),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gt=function(t){function e(e,n){var o=t.call(this)||this;return o.runId=-1,o._loopComplete=!1,o.data=n,o.component=e,o.eventName=n.event,o.system=!0===n.system,o.global=!0===n.global,o.funName=n.funName,o}return yt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this._loopComplete=!0,0===this.loopTask.tasks.length&&this.component&&this.funName){this.callfunData={type:12,name:this.funName,params:[]};var e=new pt(this.component,this.funName,this.callfunData);this.callfun=e,this.loopTask.addTask(e)}if(this.loopTask&&this.loopTask.on(V.EVENT_COMPLETE,this.onLoopComplete,this),this.component)if(this.system)(n=this.component.vfStage)&&n.systemEvent.on(this.eventName,this.onTriger,this);else if(this.global){var n;(n=this.component.vfStage)&&n.on(this.eventName,this.onTriger,this)}else this._component=j(this.component,this.data.target),this._component&&this._component.on(this.eventName,this.onTriger,this);this.complete()},e.prototype.stop=function(){if(this.complete(),this._component)if(this.system)(e=this._component.vfStage)&&e.systemEvent.off(this.eventName,this.onTriger,this);else if(this.global){var e;(e=this._component.vfStage)&&e.off(this.eventName,this.onTriger,this)}else this._component.off(this.eventName,this.onTriger,this);this.loopTask&&(this.loopTask.off(V.EVENT_COMPLETE,this.onLoopComplete),this.loopTask.complete()),t.prototype.stop.call(this)},e.prototype.break=function(){this.complete(),t.prototype.break.call(this)},e.prototype.onLoopComplete=function(){this._loopComplete=!0},e.prototype.onSystemTriger=function(t){t.code===this.eventName&&this.onTriger(t)},e.prototype.onTriger=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._isPaused||(t&&t.length>0&&this.callfunData&&(this.callfunData.params=t),this.loopTask&&this._loopComplete&&(this._loopComplete=!1,this.loopTask.run()))},e}(J),_t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bt=function(t){function e(e,n){var o=t.call(this)||this;return o._loopComplete=!1,o.component=e,o.data=n,o.eventName=n.event,o.system=!0===n.system,o.global=!0===n.global,o}return _t(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component)if(this.system)(e=this.component.vfStage)&&e.systemEvent.off(this.eventName);else if(this.global){var e;(e=this.component.vfStage)&&e.off(this.eventName)}else this._component=j(this.component,this.data.target),this._component&&this._component.off(this.eventName);this.complete()},e}(Y),Tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),wt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o.eventName=n.event,o.eventData=n.eventData,o.system=!0===n.system,o.global=!0===n.global,o}return Tt(e,t),e.prototype.run=function(){t.prototype.run.call(this);var e=this.component;if(e){var n=this.getEmitEventData();if(this.system){if(e.vfStage){var o=e.vfStage.systemEvent;"object"==typeof n?(n.type=this.eventName,"message"!==this.eventName&&o.emit(this.eventName,n),o.emit("message",n)):o.emitError("S0003",[this.eventName,JSON.stringify(n)],"warning",this)}}else this.global?e.vfStage&&e.vfStage.emit(this.eventName,n):(this.target=j(this.component,this.data.target),this.target&&this.target.emit(this.eventName,n))}this.complete()},e.prototype.stop=function(){this.complete(),t.prototype.stop.call(this)},e.prototype.break=function(){this.complete(),t.prototype.break.call(this)},e.prototype.getEmitEventData=function(){if(Array.isArray(this.eventData)&&this.component){var t=this.component.vfStage;if(t)return t.variableManager.getExpressItemValue(this.component,this.eventData)}return this.eventData},e}(Y);function xt(t,e){var n=t.tasks;if(n)for(var o=0,r=n.length;o<r;o++)Et(n[o],e)}function Et(t,e){if(t instanceof tt)Ot(t.data.express,e);else if(t instanceof nt){for(var n=t.conditions,o=0,r=n.length;o<r;o++){Ot(n[o],e)}if(t.conditionsRun)for(var i=t.conditionsRun,a=0,s=i.length;a<s;a++){xt(i[a],e)}t.elseRun&&xt(t.elseRun,e)}else t instanceof Q?t.data.value&&Array.isArray(t.data.value)&&At(t.data.value,e):t instanceof at?(t.data.name&&Array.isArray(t.data.name)&&At(t.data.name,e),t.data&&t.data.target&&At(t.data.target,e)):t instanceof ct?t.data.assetId&&Array.isArray(t.data.assetId)&&At(t.data.assetId,e):t instanceof pt?(t.data&&t.data.params&&Ot(t.data.params,e),t.data&&t.data.target&&At(t.data.target,e)):t instanceof ht?t.data&&t.data.value&&At(t.data.value,e):t instanceof dt?t.injectParams(e):(t instanceof K||t instanceof gt||t instanceof bt||t instanceof wt||t instanceof mt)&&t.data&&t.data.target&&At(t.data.target,e)}function Ot(t,e){if(t&&Array.isArray(t))for(var n=0,o=t.length;n<o;n++){At(t[n],e)}}function At(t,e){if(t[0]===o.PARAM_VALUE){var n=t[1];e.length>n&&(t[2]=e[n])}else t[0]===o.ARRAY_VALUE&&Array.isArray(t[3])&&At(t[3],e)}var Pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),St=function(t){function e(e,n){var o=t.call(this)||this;return o.callTargets=[],o._loopComplete=!1,o._component=e,o.funName=n,o}return Pt(e,t),e.prototype.injectParams=function(t){this.loopTask&&xt(this.loopTask,t)},e.prototype.runWithId=function(t){this._isRunning||(this.callTargets.push(t),this.run())},e.prototype.stopWithId=function(t){var e=this.callTargets.indexOf(t);e>=0&&(e>0?this.callTargets.splice(e,1):(this.callTargets.splice(e,1),this._isRunning&&this.loopTask.stop()))},e.prototype.breakWithId=function(t){var e=this.callTargets.indexOf(t);e>=0&&(e>0?this.callTargets.splice(e,1):(this.callTargets.splice(e,1),this._isRunning&&this.loopTask.break()))},e.prototype.run=function(){t.prototype.run.call(this),this._loopComplete=!0,this.loopTask&&(this.loopTask.on(V.EVENT_COMPLETE,this.onLoopComplete,this),this.loopTask.on(V.EVENT_BREAK,this.onBreak,this)),this.callTargets.length>0?this.loopTask.run():this.complete()},e.prototype.stop=function(){this.complete(),t.prototype.stop.call(this)},e.prototype.break=function(){this.complete(),t.prototype.break.call(this)},e.prototype.complete=function(){this.callTargets.length=0,this.loopTask.off(V.EVENT_COMPLETE,this.onLoopComplete,this),this.loopTask.off(V.EVENT_BREAK,this.onBreak,this),t.prototype.complete.call(this)},e.prototype.onLoopComplete=function(){if(this.callTargets.length>0){var t=this.callTargets[0];this.callTargets.shift(),this._isRunning=!1,this.emit(V.FUNCTION_RUN_COMPLETE,t)}this.callTargets.length>0?this.loopTask.run():this.complete()},e}(J),Ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),kt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.transition=n,o}return Ct(e,t),e.prototype.run=function(){t.prototype.run.call(this);var e=this.component.vfStage;e?(e.switchToNextScene(this.transition),this.complete()):this.complete()},e}(Y),Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),It=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.transition=n,o}return Mt(e,t),e.prototype.run=function(){t.prototype.run.call(this);var e=this.component.vfStage;e?(e.switchToPrevScene(this.transition),this.complete()):this.complete()},e}(Y),Lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Rt=function(t){function e(e,n,o){var r=t.call(this)||this;return r.component=e,r.sceneId=n,r.transition=o,r}return Lt(e,t),e.prototype.run=function(){t.prototype.run.call(this);var e=this.component.vfStage;e?(e.switchToSceneId(this.sceneId,this.transition),this.complete()):this.complete()},e}(Y),Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),jt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Nt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);e&&e.value.pop()}this.complete()},e}(Y),Dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Vt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Dt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);if(e)e.value.push(this.data.value)}this.complete()},e}(Y),Ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Ft(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);if(e){var n=this.data.value;void 0!==n?e.value.splice(this.data.start,this.data.deleteCount||0,n):e.value.splice(this.data.start,this.data.deleteCount||0)}}this.complete()},e}(Y),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Gt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Ut(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager,n=e.getVariableByData(this.component,this.data.target);if(n){var o=n.value;e.shuffle(o)}}this.complete()},e}(Y),Xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Xt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);e&&(e.value=this.data.value)}this.complete()},e}(Y),Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Ht(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager,n=e.getVariableByData(this.component,this.data.target),o=e.getVariableByData(this.component,this.data.concatArr);n&&o&&(this.data.value?n.value=o.value.concat(this.data.value):n.value=o.value.concat())}this.complete()},e}(Y),Wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Wt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);e&&e.value.shift()}this.complete()},e}(Y),qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return qt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component.vfStage&&this.data.target){var e=this.component.vfStage.variableManager.getVariableByData(this.component,this.data.target);if(e)e.value.unshift(this.data.value)}this.complete()},e}(Y),Zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qt=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return Zt(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component&&this.component.vfStage){var e=this.component.vfStage.variableManager,n=j(this.component,this.data.target);n?e.addVariableDataToComponent(n,this.data.varId,this.data.variableType,this.data.value):e.addVariableDataToGlobal(this.data.varId,this.data.variableType,this.data.value)}this.complete()},e}(Y),$t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),te=function(t){function e(){return t.call(this)||this}return $t(e,t),e.prototype.run=function(){t.prototype.run.call(this),this.break(),this.complete()},e}(Y),ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ne=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return ee(e,t),Object.defineProperty(e.prototype,"timeout",{get:function(){var t=0;Array.isArray(this.data.value)?this.component&&this.component.vfStage&&(t=this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.value)):t=this.data.value;return D(t)||(t=1),t},enumerable:!0,configurable:!0}),e.prototype.run=function(){var e=this;t.prototype.run.call(this);var n=this.timeout;this.timeoutHandler=vf.gui.Scheduler.setTimeout(n,(function(){e.timeoutHandler&&(e.timeoutHandler.stop(),e.timeoutHandler=void 0),e.complete()}))},e}(Y),oe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),re=function(t){function e(e,n){var o=t.call(this)||this;return o.component=e,o.data=n,o}return oe(e,t),Object.defineProperty(e.prototype,"timeout",{get:function(){var t=0;Array.isArray(this.data.value)?this.component&&this.component.vfStage&&(t=this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.value)):t=this.data.value;return D(t)||(t=1),t},enumerable:!0,configurable:!0}),e.prototype.run=function(){var e=this;t.prototype.run.call(this);var n=this.timeout;this.timeoutHandler=vf.gui.Scheduler.setTimeout(n,(function(){e.timeoutHandler&&(e.timeoutHandler.stop(),e.timeoutHandler=void 0),e.loopTask&&e.loopTask.run()})),this.complete()},e}(J),ie=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ae=function(t){function e(e,n){var o=t.call(this)||this;return o.lastTimes=0,o.loopTaskComplete=!0,o.intervalComplete=!0,o._timeout=0,o._times=1,o.component=e,o.data=n,o}return ie(e,t),Object.defineProperty(e.prototype,"timeout",{get:function(){var t=0;Array.isArray(this.data.value)?this.component&&this.component.vfStage&&(t=this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.value)):t=this.data.value;return D(t)||(t=1),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"times",{get:function(){var t=0;Array.isArray(this.data.times)?this.component&&this.component.vfStage&&(t=this.component.vfStage.variableManager.getExpressItemValue(this.component,this.data.times)):t=void 0===this.data.times?0:this.data.times;return D(t)||(t=0),t},enumerable:!0,configurable:!0}),e.prototype.run=function(){t.prototype.run.call(this),this._timeout=this.timeout,this._times=this.times,this.lastTimes=this._times,this.loopTask&&this.loopTask.addListener(V.EVENT_COMPLETE,this.onLoopComplete,this),this.runOnce(this._timeout,this._times)},e.prototype.complete=function(){t.prototype.complete.call(this),this.timeoutHandler&&(this.timeoutHandler.stop(),this.timeoutHandler=void 0),this.loopTask&&this.loopTask.removeListener(V.EVENT_COMPLETE,this.onLoopComplete,this)},e.prototype.stop=function(){t.prototype.stop.call(this),this.complete()},e.prototype.resume=function(){this._isPaused&&this.loopTaskComplete&&this.intervalComplete&&this.checkComplete(this._timeout,this._times),t.prototype.resume.call(this)},e.prototype.onLoopComplete=function(){this.loopTaskComplete=!0,this.intervalComplete&&this.checkComplete(this._timeout,this._times)},e.prototype.runOnce=function(t,e){var n=this;this.intervalComplete=!1,void 0===this.timeoutHandler?this.timeoutHandler=vf.gui.Scheduler.setTimeout(t,(function(){n.intervalComplete=!0,n.timeoutHandler&&n.timeoutHandler.stop(),n.loopTaskComplete&&n.intervalComplete&&n.checkComplete(t,e)})):this.timeoutHandler.restart()},e.prototype.checkComplete=function(t,e){if(!this._isPaused&&!this._isCompleted){e>0&&!(this.lastTimes>0)?this.complete():(this.lastTimes--,this.loopTask?(this.loopTaskComplete=!1,this.runOnce(t,e),this.loopTask.run()):this.complete())}},e}(J),se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ce=function(t){function e(e,n){var o=t.call(this)||this;return o.loopTaskComplete=!0,o.component=e,o.data=n,o}return se(e,t),e.prototype.run=function(){if(t.prototype.run.call(this),this.component){var e=this.component.vfStage;e&&e.app?(this.loopTask&&this.loopTask.addListener(V.EVENT_COMPLETE,this.onLoopComplete,this),e.app.ticker.add(this.tick,this)):this.complete()}else this.complete()},e.prototype.complete=function(){if(t.prototype.complete.call(this),this.loopTask&&this.loopTask.removeListener(V.EVENT_COMPLETE,this.onLoopComplete,this),this.component){var e=this.component.vfStage;e&&e.app&&e.app.ticker.remove(this.tick,this)}},e.prototype.stop=function(){t.prototype.stop.call(this),this.complete()},e.prototype.pause=function(){if(t.prototype.pause.call(this),this.component){var e=this.component.vfStage;e&&e.app&&e.app.ticker.remove(this.tick,this)}},e.prototype.resume=function(){if(this._isPaused&&this.component){var e=this.component.vfStage;e&&e.app&&e.app.ticker.add(this.tick,this)}t.prototype.resume.call(this)},e.prototype.onLoopComplete=function(){this.loopTaskComplete=!0},e.prototype.tick=function(){this.loopTaskComplete&&this.loopTask&&this.loopTask.run()},e}(J),ue=function(){function t(t,e){this._actionList=[],this.component=t,this.data=e,this.parseData()}return t.prototype.run=function(){if(this._actionList&&this._actionList.length)for(var t=0,e=this._actionList.length;t<e;t++){this._actionList[t].run()}},t.prototype.stop=function(){if(this._actionList&&this._actionList.length)for(var t=0,e=this._actionList.length;t<e;t++){this._actionList[t].stop()}},t.prototype.pause=function(){if(this._actionList&&this._actionList.length)for(var t=0,e=this._actionList.length;t<e;t++){this._actionList[t].pause()}},t.prototype.resume=function(){if(this._actionList&&this._actionList.length)for(var t=0,e=this._actionList.length;t<e;t++){this._actionList[t].resume()}},t.prototype.parseData=function(){this.data&&Array.isArray(this.data)&&this.parseAST(this.data)},t.prototype.addGlobalVariable=function(t){this.component&&this.component.vfStage&&this.component.vfStage.variableManager.addVariableDataToGlobal(t.varId,t.variableType,t.value)},t.prototype.parseAST=function(t){if(t)for(var e=0,n=t.length;e<n;e++){var o=this.parseAction(t[e]);o&&this._actionList.push(o)}},t.prototype.parseAction=function(t){var e;switch(t.type){case 1:e=this.parseAddToStageBefore(t);break;case 2:e=this.parseAddToStage(t);break;case 4:e=this.parseSetProperty(t);break;case 5:e=this.parseClick(t);break;case 6:e=this.parseExpress(t);break;case 7:e=this.parseIf(t);break;case 11:e=this.parseDefineFunction(t);break;case 12:e=this.parseCallFunction(t);break;case 0:e=this.parsePrint(t);break;case 13:e=this.parseAddEventListener(t);break;case 14:e=this.parseRemoveEventListener(t);break;case 15:e=this.parseEmitEvent(t);break;case 16:case 33:case 34:e=this.parseSound(t);break;case 17:e=this.parsePlayAnimation(t);break;case 18:e=this.parseJumpToNextScene(t);break;case 19:e=this.parseJumpToPrevScene(t);break;case 20:e=this.parseJumpToScene(t);break;case 21:e=new Yt(this.component,t);break;case 22:e=new jt(this.component,t);break;case 23:e=new Vt(this.component,t);break;case 24:e=new Bt(this.component,t);break;case 25:e=new Gt(this.component,t);break;case 26:e=new zt(this.component,t);break;case 27:e=new Jt(this.component,t);break;case 28:e=new Kt(this.component,t);break;case 29:e=this.parseAddEventListenerCall(t);break;case 37:e=new Qt(this.component,t);break;case 30:e=new mt(this.component,t);break;case 31:var n=t,o={type:30,target:n.target,name:"gotoPlay",params:[]};Array.isArray(n.name)?o.params.push(n.name):o.params.push([0,n.name]),Array.isArray(n.frame)?o.params.push(n.frame):o.params.push([0,n.frame]),Array.isArray(n.times)?o.params.push(n.times):o.params.push([0,n.times]),e=new mt(this.component,o);break;case 32:var r=t,i={type:30,target:r.target,name:"gotoStop",params:[]};Array.isArray(r.name)?i.params.push(r.name):i.params.push([0,r.name]),Array.isArray(r.frame)?i.params.push(r.frame):i.params.push([0,r.frame]),e=new mt(this.component,i);break;case 38:e=this.parseFor(t);break;case 39:e=new te;break;case 40:e=new ne(this.component,t);break;case 41:e=this.parseSetTimeout(t);break;case 42:e=this.parseSetInterval(t);break;case 43:e=this.parseEnterFrame(t)}return e},t.prototype.parseSubTask=function(t,e){if(e.execute)for(var n=0,o=e.execute.length;n<o;n++){var r=e.execute[n],i=this.parseAction(r);i&&t.addSubTask(i)}},t.prototype.parseAddToStageBefore=function(t){var e=new K(this.component,{type:13,event:"Add",target:[]});return this.parseSubTask(e,t),e},t.prototype.parseAddToStage=function(t){var e=new K(this.component,{type:13,event:"Added",target:[]});return this.parseSubTask(e,t),e},t.prototype.parseSetProperty=function(t){return new Q(this.component,t)},t.prototype.parseClick=function(t){var e={event:"click",type:13,target:t.target},n=new K(this.component,e);return this.parseSubTask(n,t),n},t.prototype.parseExpress=function(t){return new tt(this.component,t)},t.prototype.parseIf=function(t){var e=new nt(this.component);if(t.execute)for(var n=0,o=t.execute.length;n<o;n++){var r=t.execute[n];if(8===r.type||9===r.type||10===r.type){var i=r.condition,a=new z;if(r.execute)for(var s=0,c=r.execute.length;s<c;s++){var u=this.parseAction(r.execute[s]);u&&a.addTask(u)}e.addCondition(i,a)}}return e},t.prototype.parseDefineFunction=function(t){var e=new St(this.component,t.name);return this.parseSubTask(e,t),new rt(this.component,t.name,t,e)},t.prototype.parseCallFunction=function(t){return new pt(this.component,t.name,t)},t.prototype.parsePrint=function(t){return new ht(this.component,t)},t.prototype.parseAddEventListener=function(t){var e=new K(this.component,t);return this.parseSubTask(e,t),e},t.prototype.parseRemoveEventListener=function(t){return new bt(this.component,t)},t.prototype.parseEmitEvent=function(t){return new wt(this.component,t)},t.prototype.parseAddEventListenerCall=function(t){if(t.funName)return new gt(this.component,t)},t.prototype.parseSound=function(t){return new ct(this.component,t)},t.prototype.parsePlayAnimation=function(t){return new at(this.component,t)},t.prototype.parseJumpToNextScene=function(t){return new kt(this.component,t.transition)},t.prototype.parseJumpToPrevScene=function(t){return new It(this.component,t.transition)},t.prototype.parseJumpToScene=function(t){return new Rt(this.component,t.value,t.transition)},t.prototype.parseFor=function(t){var e=new dt(this.component,t);return this.parseSubTask(e,t),e},t.prototype.parseSetTimeout=function(t){var e=new re(this.component,t);return this.parseSubTask(e,t),e},t.prototype.parseSetInterval=function(t){var e=new ae(this.component,t);return this.parseSubTask(e,t),e},t.prototype.parseEnterFrame=function(t){var e=new ce(this.component,t);return this.parseSubTask(e,t),e},t}(),pe=function(){function t(){this.type=null,this.frames=[],this.curTime=0,this.lastTime=0,this.loop=!1,this.totalTime=0,this._defaultValue=null,this._globalTime=0,this._lastGlobalTime=0,this._lastFrame=null,this._curFrame=null,this._nextFrame=null,this._times=-1,this._curValue=null}return Object.defineProperty(t.prototype,"defaultValue",{set:function(t){this._defaultValue=t,this._curValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curValue",{get:function(){return this._curValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalTime",{set:function(t){this._globalTime=t,this.tick(),this._lastGlobalTime=t},enumerable:!0,configurable:!0}),t.prototype.getProgress=function(t,e,n,o){void 0===o&&(o=null);var r=0,i=0;(i=r=n===e?0:(t-e)/(n-e),o&&o.length)&&(1===o.length&&(i=function(t,e){var n=0;switch(t){case 0:return 0;case 1:return e;case 2:return-(Math.pow(e-1,2)-1);case 3:return Math.pow(e,2);case 4:return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2);case 5:return Math.pow(e,3);case 6:return Math.pow(e-1,3)+1;case 7:return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2);case 8:return Math.pow(e,3);case 9:return-(Math.pow(e-1,4)-1);case 10:return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2);case 11:return Math.pow(e,5);case 12:return Math.pow(e-1,5)+1;case 13:return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2);case 14:return 1-Math.cos(e*(Math.PI/2));case 15:return Math.sin(e*(Math.PI/2));case 16:return-.5*(Math.cos(Math.PI*e)-1);case 17:return 0===e?0:Math.pow(2,10*(e-1));case 18:return 1===e?1:1-Math.pow(2,-10*e);case 19:return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e));case 20:return-(Math.sqrt(1-e*e)-1);case 21:return Math.sqrt(1-Math.pow(e-1,2));case 22:return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1);case 23:return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375;case 24:return e*e*(((n=1.70158)+1)*e-n);case 25:return(e-=1)*e*(((n=1.70158)+1)*e+n)+1;case 26:return n=1.70158,(e/=.5)<1?e*e*((1+(n*=1.525))*e-n)*.5:.5*((e-=2)*e*((1+(n*=1.525))*e+n)+2);case 27:case 28:return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1;case 29:return-1*Math.pow(6,-6*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1;case 30:return n=1.70158,(e/=.5)<1?e*e*((1+(n*=1.525))*e-n)*.5:.5*((e-=2)*e*((1+(n*=1.525))*e+n)+2);case 31:return e*e*(((n=1.70158)+1)*e-n);case 32:return(e-=1)*e*(((n=1.70158)+1)*e+n)+1;case 33:return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375;case 34:return e<1/2.75?7.5625*e*e:e<2/2.75?2-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?2-(7.5625*(e-=2.25/2.75)*e+.9375):2-(7.5625*(e-=2.625/2.75)*e+.984375);case 35:return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2);case 36:return Math.pow(e,4);case 37:return Math.pow(e,.25);case 38:return-Math.cos(e*Math.PI)/2+.5;case 39:return 1-e;case 40:return-Math.cos(e*Math.PI*(9*e))/2+.5;case 41:return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e);default:return e}}(o[0],r)));return i},t.prototype.tick=function(){this.curTime=this._globalTime,this.loop&&(this._times=Math.floor(this.curTime/this.totalTime),this.curTime=this.curTime-this.totalTime*this._times),this.updateCurFrame(),this.updateCurValue(),this.lastTime=this.curTime},t.prototype.updateCurFrame=function(){if(0!==this.frames.length){this._lastFrame=this._curFrame;var t,e=0;for(e=0,t=this.frames.length;e<t;e++)if(this.frames[e].time>this.curTime)return void(0===e?(this._curFrame=null,this._nextFrame=this.frames[e]):(this._curFrame=this.frames[e-1],this._nextFrame=this.frames[e]));this._curFrame=this.frames[this.frames.length-1],this._nextFrame=this._curFrame}},t.prototype.updateCurValue=function(){if(this._curFrame&&this._nextFrame){var t=this.getProgress(this.curTime,this._curFrame.time,this._nextFrame.time,this._curFrame.curve);this._curValue=this._curFrame.getValue(t,this._nextFrame.value)}},t}(),le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),he=function(t){function e(){var e=t.call(this)||this;return e.nextFrameIndex=0,e.skipEmit=!1,e._curValue=[],e}return le(e,t),e.prototype.skipNextEmit=function(){this.lastTime=0,this.nextFrame=void 0},e.prototype.getProgress=function(t,e,n,o){return void 0===o&&(o=null),t},e.prototype.updateCurFrame=function(){this.frames.length},e.prototype.updateCurValue=function(){this._curValue.length=0,0!==this.frames.length&&(void 0===this.nextFrame&&(this.nextFrame=this.frames[0],this.nextFrameIndex=0),this.curTime>=this.lastTime?this.curTime>this.nextFrame.time&&this.findEvents(this.nextFrameIndex,!1):this.findEvents(0,!0))},e.prototype.findEvents=function(t,e){if(void 0===e&&(e=!1),e)for(var n=this.nextFrameIndex,o=this.frames.length;n<o;n++){var r=this.frames[n];this.addEvent(r)}for(n=t,o=this.frames.length;n<o;n++){if((r=this.frames[n]).time<this.curTime&&(e||r.time>=this.lastTime))this.addEvent(r);else if(r.time>this.curTime){this.nextFrame=r,this.nextFrameIndex=n;break}this.nextFrameIndex=Number.MAX_VALUE}},e.prototype.addEvent=function(t){if(t.value)for(var e=0,n=t.value.length;e<n;e++)this._curValue.push(t.value[e])},e}(pe),fe=function(){function t(t){this.timelines=[],this.fps=30,this.totalTime=0,this.loop=!1,this._curTime=0,this._curFrame=0,this.name=t}return Object.defineProperty(t.prototype,"targetDisplay",{get:function(){return this.target},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curTime",{set:function(t){this._curTime=t,this._curFrame=this._curTime*this.fps/1e3,this.loop&&(this._curFrame=this._curFrame%this.totalTime);for(var e=0,n=this.timelines.length;e<n;e++)this.timelines[e].globalTime=this._curFrame;this.applyTimeline()},enumerable:!0,configurable:!0}),t.prototype.skipNextEvent=function(){for(var t=0,e=this.timelines.length;t<e;t++){var n=this.timelines[t];n instanceof he&&n.skipNextEmit()}},t.prototype.applyTimeline=function(){if(null!=this.target)for(var t=0,e=this.timelines.length;t<e;t++){var n=this.timelines[t],o=this.targetDisplay,r=n.curValue;switch(n.type){case"x":o.x=r;break;case"y":o.y=r;break;case"scaleX":o.scaleX=r;break;case"scaleY":o.scaleY=r;break;case"rotation":o.rotation=r;break;case"visible":o.visible=r;break;case"alpha":o.alpha=r;break;case"text":o.text=r;break;case"enabled":o.enabled=r;break;case"filterBlur":o.filterBlur=r;break;case"event":var i=r;if(i)for(var a=0,s=i.length;a<s;a++){var c=i[a];o.emit(c.type,c.data)}break;default:0===n.type.indexOf("filter")?this.applyFilter(o,n.type,r):o[n.type]=r}}},t.prototype.applyFilter=function(t,e,n){for(var o=e.split("."),r=t,i=0,a=o.length;i<a-1;i++){var s=o[i];r&&r[s]&&(r=r[s])}r&&(r[o[o.length-1]]=n)},t}(),de=function(){function t(){this.time=-1,this.curve=[],this.value=null}return t.prototype.getValue=function(t,e){return null},t}(),ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),me=function(t){function e(){return t.call(this)||this}return ve(e,t),e.prototype.getValue=function(t,e){return this.value+(e-this.value)*t},e}(de),ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ge=function(t){function e(){return t.call(this)||this}return ye(e,t),e.prototype.getValue=function(t,e){return this.value},e}(de),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),be=function(t){function e(){return t.call(this)||this}return _e(e,t),e.prototype.getValue=function(t,e){return this.value},e}(de),Te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),we=function(t){function e(){return t.call(this)||this}return Te(e,t),e.prototype.getValue=function(t,e){var n=this.changeColor2RGB(this.value),o=this.changeColor2RGB(e),r=[n[0]+(o[0]-o[0])*t,n[1]+(o[1]-o[1])*t,n[2]+(o[2]-o[2])*t];return this.changeRGB2Color(r)},e.prototype.changeColor2RGB=function(t){return[t>>16&255,t>>8&255,t>>0&255]},e.prototype.changeRGB2Color=function(t){return 65536*t[0]+256*t[1]+t[2]},e}(de),xe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ee=function(t){function e(){return t.call(this)||this}return xe(e,t),e.prototype.getValue=function(t,e){return this.value},e}(de),Oe=function(){function t(t,e,n,o){void 0===n&&(n=30),void 0===o&&(o=!0),this.animationMap={},this.animationConfig={},this.status=0,this.curAnimationClips=[],this.realFPS=!1,this.curTime=0,this.lastTime=0,this.curPlayTime=0,this.startTime=0,this.passedTime=0,this.minDeltaT=33,this.deltaT=0,this.fps=30,this.curAnimatinName="",this.curAnimatinDuration=0,this.curAnimatinDurationTime=0,this.curAnimationTimes=0,this.curAnimationTotalTime=0,this._curPlayTimes=0,this.component=t,this.data=e,this.realFPS=o,n>0&&(this.fps=n),this.minDeltaT=Math.ceil(1e3/this.fps),this.deltaT=0,this.parseData()}return t.prototype.addAnimationClip=function(t){var e=t.name,n=this.animationMap[e];null==n&&(n=[],this.animationMap[e]=n),n.push(t)},t.prototype.getPauseData=function(){if(1===this.status)return{animation:this.curAnimatinName,frame:Math.round(this.curPlayTime*this.fps/1e3),times:this.curAnimationTimes<=0?this.curAnimationTimes:this.curAnimationTimes-this._curPlayTimes}},t.prototype.playDefaultAnimation=function(){if(1!==this.status)for(var t in this.animationConfig)if(this.animationConfig[t]){var e=this.animationConfig[t];if(e.autoPlay){this.play(t,e.loop?-1:1);break}}},t.prototype.gotoPlay=function(t,e,n){void 0===n&&(n=1),1===this.status&&this.stop();var o=this.animationConfig[t];o?(this.curAnimatinDuration=o.totalTime,this.curAnimatinName=t,this.curAnimationClips=this.animationMap[t],this.curAnimationTimes=n,this.curAnimationTotalTime=Math.round(this.curAnimatinDuration*this.curAnimationTimes*(1e3/this.fps)),this.curAnimatinDurationTime=Math.round(1e3*this.curAnimatinDuration/this.fps),this.curPlayTime=e*(1e3/this.fps),this.deltaT=0,this.setCurTime(this.curPlayTime),this.status=1,this.startTime=(new Date).getTime(),this.curTime=this.startTime,this.lastTime=this.startTime,this.startTime-=this.curPlayTime,this._curPlayTimes=0,vf.Ticker.shared.add(this.tick,this)):console.warn("can not find animation:",t)},t.prototype.gotoStop=function(t,e){1===this.status&&this.stop();var n=this.animationConfig[t];n?(this.curAnimatinDuration=n.totalTime,this.curAnimationClips=this.animationMap[t],this.curAnimationTimes=1,this.curAnimationTotalTime=Math.round(this.curAnimatinDuration*this.curAnimationTimes*(1e3/this.fps)),this.curAnimatinDurationTime=Math.round(1e3*this.curAnimatinDuration/this.fps),this.curPlayTime=e*(1e3/this.fps),this.deltaT=0,this.setCurTime(this.curPlayTime),this.status=0,this.startTime=(new Date).getTime(),this.curTime=this.startTime,this.lastTime=this.startTime,this.startTime-=this.curPlayTime,this._curPlayTimes=0,this.tick()):console.warn("can not find animation:",t)},t.prototype.play=function(t,e){void 0===e&&(e=1),this.gotoPlay(t,0,e)},t.prototype.stop=function(){vf.Ticker.shared.remove(this.tick,this),this.status=0,this.skipNextEvent()},Object.defineProperty(t.prototype,"curPlayTimes",{set:function(t){t!==this._curPlayTimes&&(this._curPlayTimes=t,this.component&&(this.component.emit("AnimationLoopComplete",t),this.curAnimationTimes>0&&this._curPlayTimes>=this.curAnimationTimes&&this.component.emit("AnimationComplete")))},enumerable:!0,configurable:!0}),t.prototype.tick=function(){var t=(new Date).getTime();this.curTime=t;var e=this.curTime-this.lastTime;if(this.curPlayTime+=e,this.realFPS){if(this.deltaT+=e,this.deltaT<this.minDeltaT)return this.lastTime=this.curTime,this.passedTime=this.curTime-this.startTime,this.curAnimationTimes>0&&this.passedTime>this.curAnimationTotalTime&&this.stop(),void(this.curPlayTimes=Math.floor(this.passedTime/this.curAnimatinDurationTime));for(;this.deltaT>this.minDeltaT;)this.deltaT-=this.minDeltaT}this.curPlayTime>this.curAnimatinDurationTime&&(this.curAnimationTimes<0||this.curAnimationTimes>1&&this._curPlayTimes<this.curAnimationTimes-1)&&(this.curPlayTime=this.curPlayTime%this.curAnimatinDurationTime),this.setCurTime(this.curPlayTime),this.lastTime=this.curTime,this.passedTime=this.curTime-this.startTime,this.curAnimationTimes>0&&this.passedTime>this.curAnimationTotalTime&&this.stop(),this.curPlayTimes=Math.floor(this.passedTime/this.curAnimatinDurationTime)},t.prototype.setCurTime=function(t){if(this.curAnimationClips)for(var e=0,n=this.curAnimationClips.length;e<n;e++){this.curAnimationClips[e].curTime=t}},t.prototype.skipNextEvent=function(){if(this.curAnimationClips)for(var t=0,e=this.curAnimationClips.length;t<e;t++){this.curAnimationClips[t].skipNextEvent()}},t.prototype.parseData=function(){if(this.component&&this.data)for(var t=0,e=this.data.length;t<e;t++)this.parseAnimation(this.data[t])},t.prototype.parseAnimation=function(t){var e=t.name,n=t.duration||0,o={loop:t.loop,totalTime:n,autoPlay:t.autoPlay};this.animationConfig[e]=o;var r=0;for(var i in t.children)if(t.children[i]){var a=this.parseAnimationClip(i,e,t.children[i]);a&&a.totalTime>r&&(r=a.totalTime)}(!t.duration||t.duration<=0)&&(t.duration=r,o.totalTime=r)},t.prototype.parseAnimationClip=function(t,e,n){var o,r=t;if(o="event"===r?this.component:this.component.getChildById(r)){var i=new fe(e);i.name=e,i.fps=this.fps,i.target=o,i.totalTime=n.duration||0,i.loop=!!n.loop;for(var a=0,s=0,c=n.timelines.length;s<c;s++){var u=n.timelines[s],p=this.parseTimeline(u,n.duration);p&&(i.timelines.push(p),p.totalTime>a&&(a=p.totalTime))}return(!i.totalTime||i.totalTime<=0)&&(i.totalTime=a),this.addAnimationClip(i),i}},t.prototype.parseTimeline=function(t,e){var n;switch(void 0===e&&(e=-1),t.type){case"x":case"y":case"scaleX":case"scaleY":case"rotation":case"skewX":case"skewY":case"alpha":case"progress":case"alpha":case"volume":case"filterBlur":n=new pe,this.parseFrames(n,t.frames,me);break;case"visible":case"enabled":n=new pe,this.parseFrames(n,t.frames,ge);break;case"text":case"play":n=new pe,this.parseFrames(n,t.frames,be);break;case"color":n=new pe,this.parseFrames(n,t.frames,we);break;case"event":n=new he,this.parseFrames(n,t.frames,Ee);break;default:n=new pe,this.parseFrames(n,t.frames,me)}return n&&(n.type=t.type,n.loop=!!t.loop,t.frames&&t.frames.length?n.totalTime=t.frames[t.frames.length-1].frame:n.totalTime=0),n},t.prototype.parseFrames=function(t,e,n){for(var o=0,r=e.length;o<r;o++){var i=e[o],a=new n;a.time=i.frame,a.curve=i.curve,a.value=i.value,t.frames.push(a)}},t}();function Ae(t){switch(t){case"gif":case"png":case"bmp":case"jpg":case"jpeg":case"tif":case"tiff":case"webp":case"tga":case"svg":case"svg+xml":return 4;case"mp3":case"ogg":case"wav":return 5;case"mp4":case"webm":case"mov":return 6;case"json":return 3;default:return 0}}function Pe(t,e,n){if(void 0===n&&(n=0),0===t.indexOf("data:"))return t;var o;switch(Ae(function(t){var e="";if(0===t.indexOf("data:")){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var o=t.indexOf("?"),r=t.indexOf("#"),i=Math.min(o>-1?o:t.length,r>-1?r:t.length);e=(t=t.substring(0,i)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()}(t))){case 4:o=e.image;break;case 5:case 6:o=e.media;break;default:o=e.default}return o=o[Math.max(n,o.length-1)%o.length],-1!==t.indexOf("http")||0===t.indexOf("//")?o+=t.substr(t.indexOf("/",t.indexOf("."))):o+=t,o}function Se(t,e,n,o){return void 0===e&&(e=""),void 0===o&&(o=0),e?-1===t.indexOf("http")&&-1===t.indexOf("//")&&(t=e+t):n&&(t=Pe(t,n,o)),t}var Ce=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},ke=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function Me(t,e,n,o){return Ce(this,void 0,void 0,(function(){var r,i;return ke(this,(function(a){return r=vf.gui,n&&r[n]?[2,r[n]]:(i=[],[2,new Promise((function(a,s){var c=0,u=function(n){var o=document.createElement("script");o.async=!1,o.src=0===n?t:Se(t,"",e,n-1),o.addEventListener("load",p,!1),o.addEventListener("error",l,!1),document.body.appendChild(o)},p=function(t){if(h(this),o&&o(),n)return r.module.hasOwnProperty(n)?(r[n]=r.module[n],r.module=null,a(r[n])):a(!1);a(!0)},l=function(t){h(this),c>3?s({code:"404",level:"error",data:[i.join("\n")]}):(-1===i.indexOf(this.src)&&i.push(this.src),u(1),c++)},h=function(t){t.parentNode.removeChild(t),t.removeEventListener("load",p,!1),t.removeEventListener("error",l,!1)};u(0)}))])}))}))}var Ie,Le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Re=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},Ne=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},je=function(t){function e(e){var n=t.call(this)||this;return n.pixiResources={},n.data=null,n.vfActions=[],n._resources=[],n._sceneMap={},n._loadNum=0,n._assetFails=new Map,vf.gui.Utils.setSourcePath(n.getImageAsset.bind(n)),vf.gui.Utils.setDisplayObjectPath(n.getDisplayObject.bind(n)),n.stage=e,n}return Le(e,t),e.prototype.destroy=function(){if(this.pixiResources)for(var t in this.pixiResources)if(this.pixiResources[t]){var e=this.pixiResources[t];e.texture?(e.texture.destroy(!0),delete this.pixiResources[t]):e.sound&&(e.sound.media&&e.sound.destroy(),delete this.pixiResources[t])}vf.utils.destroyTextureCache(),vf.utils.clearTextureCache(),this._loader&&this._loader.destroy(),this.stage=void 0,this._sceneMap={}},e.prototype.addResource=function(t){this._resources.push(t)},e.prototype.loadData=function(t){return Re(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return this.data=t,this.data&&this.data.assets?[4,this.loadAllScript()]:[3,3];case 1:return e.sent(),[4,this.loadAllAsset()];case 2:return e.sent(),[3,4];case 3:this.emit("LoadComplete",null),e.label=4;case 4:return[2]}}))}))},e.prototype.createFirstScene=function(t){return this.initGlobalVariable(),this.data.scenes&&this.data.scenes.length>0?this.createScene(this.data.scenes[0].id,t):null},e.prototype.createNextScene=function(t,e){var n=this.getNextSceneData(t);return n?this.createScene(n.id,e):null},e.prototype.createPrevScene=function(t,e){var n=this.getPrevSceneData(t);return n?this.createScene(n.id,e):null},e.prototype.createScene=function(t,e){var n=this.getSceneData(t);if(n){var o=this._sceneMap[t];if(null==o&&((o=new G(e)).transition=n.transition),o.id=t,this._sceneMap[t]=o,n.libId){var r=this.createComponent(n.libId,n.id);r&&(r.width=e.width,r.height=e.height,o.addComponent(r))}return o}return null},e.prototype.getImageAsset=function(t){if("data"===t.toString().substr(0,4))return t.toString();var e=this.getAsset(t);if(e)switch(this.data.assets[t].type){case"image":return e.texture;case"sheet":return e.spritesheet;default:return e}},e.prototype.getDisplayObject=function(t,e){if(null!=t){if("this"===t.toString().substr(0,4)&&e&&e.parent instanceof c){var n=t.split("#");n.shift();for(var o=e.parent;n.length>0&&o;){var r=n.shift();o=o.getChildById(r)}return o||void this.stage.systemEvent.emitError("E0006",[t],"warning")}return this.creategui(t)}},e.prototype.getAsset=function(t){var e=this.data.assets[t];if(void 0!==e&&null!=e.id)return this.pixiResources[e.id.toString()];this.stage.systemEvent.emitError("E0003",[t],"warning")},e.prototype.loadAllScript=function(){return Re(this,void 0,void 0,(function(){var t,e,n,o,r,i,a,s,c=this;return Ne(this,(function(u){switch(u.label){case 0:for(r in t=this.data.assets,e=this.stage.config.cdns,o=[],t)o.push(r);i=0,u.label=1;case 1:return i<o.length?(a=o[i],(n=t[a])&&"js"===n.type&&n.name?[4,Me(n.url,e,n.name).catch((function(t){c.stage.systemEvent.error(t)}))]:[3,3]):[3,4];case 2:(s=u.sent())&&s.isFilter&&vf.gui.Filter.list.set(n.name,s),u.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.loadAllAsset=function(){return Re(this,void 0,void 0,(function(){var t,e,n;return Ne(this,(function(o){for(n in t=this.data.assets)if(t[n]){if(void 0===(e=t[n])||void 0===e.type||void 0===e.url){this.stage.systemEvent.emitError("E0001",[n]);continue}if(""===e.url){this.stage.systemEvent.emitError("E0003",[n],"warning");continue}if("audio"===e.type&&this.stage.config.vfvars.useNativeAudio){this.stage.systemEvent.emitError("S0004",[n],"warning");continue}if("js"===e.type)continue;e.id=n,this.addResource(t[n])}return this.loadResources(),[2]}))}))},e.prototype.initGlobalVariable=function(){if(this.data.global&&(this.stage.variableManager.addVariableConfig(F.GLOBAL_ID,this.data.global),this.stage.variableManager.addVariableToGlobal(this.data.global)),this.vfActions)for(var t=0,e=this.vfActions.length;t<e;t++){var n=this.vfActions[t];if(n&&37===n.type){var o=n;this.stage.variableManager.addVariableDataToGlobal(o.varId,o.variableType,o.value)}}},e.prototype.getSceneData=function(t){if(this.data.scenes)for(var e=0,n=this.data.scenes.length;e<n;e++)if(this.data.scenes[e].id===t)return this.data.scenes[e];return null},e.prototype.getNextSceneData=function(t){if(this.data.scenes)for(var e=0,n=this.data.scenes.length;e<n;e++)if(this.data.scenes[e].id===t&&e<n-1)return this.data.scenes[e+1];return null},e.prototype.getPrevSceneData=function(t){if(this.data.scenes)for(var e=0,n=this.data.scenes.length;e<n;e++)if(this.data.scenes[e].id===t&&e>0)return this.data.scenes[e-1];return null},e.prototype.createComponent=function(t,e){var n=this.data.components[t],o=null;if(n)switch(n.type){case"custom":o=this.createCustomComponent(t,e),void 0!==n.interactabled&&(o.interactabled=n.interactabled),void 0!==n.style&&(o.style=n.style);break;default:o=this.creategui(t)}return o},e.prototype.creategui=function(t){var e=this.data.components[t];if(!e)return null;var n,o=e.type;try{n=new(vf.gui.Utils.getGuiClass(o))}catch(e){throw this.stage.systemEvent.emitError("E0004",[t]),new Error("guiNamespace['"+o+"'] === undefined")}if(n)for(var r in e)if(r in e)switch(r){case"id":n.libId=e[r];break;case"name":n.libName=e[r];break;case"type":case"children":case"animations":case"actions":case"libs":break;default:n[r]=e[r]}return n},e.prototype.createCustomComponent=function(t,e){var n=this.data.components[t],o=new c;if(o.name=n.name,o.libId=t,o.id=e,n.props&&(this.stage.variableManager.addVariableConfig(t.toString(),n.props),this.stage.variableManager.addVariableToComponent(o)),n.children)for(var r=0,i=n.children.length;r<i;r++){var a=n.children[r];if("libId"in a){var s=this.data.components[a.libId],u=this.createComponent(a.libId,a.id);u&&(s.type,this.applyDisplayComponentProperty(u,a),o.addChild(u))}}if(n.actionList&&""!==n.actionList){var p=new ue(o,n.actionList);o.actionList=p}else if(void 0!==t){var l=this.getVfsByComponentId(t.toString());if(l){p=new ue(o,l);o.actionList=p}}if(n.animations){var h=this.stage.config.realFPS,f=new Oe(o,n.animations,this.data.fps,h);o.animation=f}return o},e.prototype.applyDisplayComponentProperty=function(t,e){for(var n in e)if(n in e)switch(n){case"libId":case"type":case"children":case"animations":case"actions":break;default:0===n.indexOf("filter")?this.applyFilter(t,n,e[n]):t[n]=e[n]}},e.prototype.applyFilter=function(t,e,n){for(var o=e.split("."),r=t,i=0,a=o.length;i<a-1;i++){var s=o[i];r&&r[s]&&(r=r[s])}r&&(r[o[o.length-1]]=n)},e.prototype.loadResources=function(){var t=this;void 0===this._loader&&(this._loader=new vf.Loader);var e=this._loader,n={};this._loadNum=0;for(var o=0,r=this._resources.length;o<r;o++){var i=this._resources[o],a=void 0===i.id?"undefined":i.id.toString();n[i.url]?n[i.url].push(i.id):("audio"===i.type||"sound"===i.type?e.add(a,Se(i.url,this.data.baseUrl),{loadType:vf.LoaderResource.LOAD_TYPE.XHR,xhrType:"arraybuff"}):e.add(a,Se(i.url,this.data.baseUrl)),n[i.url]=[a])}var s,c=0,u=0;s=e.onProgress.add((function(e,n){t._loadNum++,t.emit("LoadProgress",[e.progress,t._loadNum,t._resources.length,n])})),c=e.onComplete.add((function(o,r){if(t.pixiResources=r,!t.loadFailResources()){for(var i in n)for(var a=n[i].shift();n[i].length>0;)t.pixiResources[n[i].shift()]=r[a];e.onComplete.detach(s),e.onComplete.detach(c),e.onComplete.detach(u),t.emit("LoadComplete",[o,r])}})),u=e.onError.add((function(e,n,o){var r=t._assetFails.get(o.name);r?(r.count>=4&&(t._assetFails.delete(o.name),t.stage.systemEvent.emitError("404",[o.url])),r.count++):t._assetFails.set(o.name,{id:o.name,url:o.url,extension:o.extension,count:1})})),e.load()},e.prototype.loadFailResources=function(){if(void 0===this._loader)return!1;if(this._assetFails.size<=0)return!1;var t=this._loader,e=this.stage.config.cdns;return this._assetFails.forEach((function(n){var o;switch(Ae(n.extension)){case 4:o=e.image;break;case 5:case 6:o=e.media;break;default:o=e.default}var r=o[(n.count-1)%o.length];-1!==n.url.indexOf("http")||0===n.url.indexOf("//")?r+=n.url.substr(n.url.indexOf("/",n.url.indexOf("."))):r+=n.url,delete t.resources[n.id],t.add(n.id,r)})),!0},e.prototype.getVfsByComponentId=function(t){if(this.vfActions)for(var e=0,n=this.vfActions.length;e<n;e++){var o=this.vfActions[e];if(o&&36===o.type&&o.value===t)return o.execute}},e}(vf.utils.EventEmitter),De=function(){function t(t,e){this.id=t,this.parent=e,this.status="init"}return t.prototype.load=function(t){if("init"===this.status)return this.onLoad(t),this.status="ready",this.parent.plugs.set(this.id,this),this},t.prototype.release=function(){"init"!==this.status&&(this.onRelease(),this.parent.plugs.delete(this.id),this.parent=null,this.status="init")},t.prototype.onLoad=function(t){},t.prototype.onRelease=function(){},t}(),Ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fe=function(t){function e(e,n){return t.call(this,e,n)||this}return Ve(e,t),e.prototype.onLoad=function(t){var e=this.parent;this.followLine=new vf.gui.FollowLine(e);var n=this.followLine;return n.role=1===t.role?"T":"S",n.width=e.width,n.height=e.height,e.addChild(n),n.on(vf.gui.Interaction.ComponentEvent.COMPLETE,this.onComplete,this),e.config.systemEvent.on("message",this.onReceipt,this),this},e.prototype.onRelease=function(){var t,e,n;this.parent.config.systemEvent.off("message",this.onReceipt,this),null===(t=this.followLine)||void 0===t||t.off(vf.gui.Interaction.ComponentEvent.COMPLETE,this.onComplete,this),null===(e=this.followLine)||void 0===e||e.offAll(),null===(n=this.followLine)||void 0===n||n.release()},e.prototype.onComplete=function(t,e){this.parent.config.systemEvent.emit("message",{type:"sendSignal",code:"sendSignal",level:"command",data:{name:"boardDraw",val:e}})},e.prototype.onReceipt=function(t){if(t.data&&"sendSignal"===t.code&&this.followLine){var e=this.followLine;"boardDraw"===t.data.name?e.setData(t.data.val):"boardRestore"===t.data.name?e.reset():"boardErase"===t.data.name?e.isErasing=t.data.val:"boardLineColor"===t.data.name&&(e.lineColor=t.data.val)}},e}(De),Be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ue=function(t){function e(e,n){var o=t.call(this,e,n)||this;n.originalEventPreventDefault=!0;var r=document.getElementById("drawCanvas");if(null==r){var i=document.getElementsByClassName("canvas-container")[0];i&&i.children[1]&&(r=i.children[1])}return null==r?(o.parent.systemEvent.emitError("E0002",["drawCanvas|canvas-container"],"warning"),o):(o.dom=r,o)}return Be(e,t),e.prototype.onLoad=function(t){var e,n;if(void 0!==this.dom){var o=this.dom,r=this.parent,i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,a=(null===(e=r.app)||void 0===e?void 0:e.renderer).plugins.interaction;this.observer=new i((function(t){t.forEach((function(t){if("attributes"===t.type){var e=t.target,n=a.currentCursorMode;if(e.dataset.cursor!==e.style.cursor){if("pointer"===n)return e.style.cursor="pointer",void(e.dataset.cursor=e.style.cursor);e.dataset.cursor=e.style.cursor}}}))})),this.observer.observe(o,{attributes:!0,attributeFilter:["style"]});var s=o.style.cursor;a.setTargetElement(o,null===(n=r.app)||void 0===n?void 0:n.renderer.resolution),a.cursorStyles.default=s,o.style.display="none",setTimeout((function(){o&&(o.style.display="")}),60)}},e.prototype.onRelease=function(){var t;null===(t=this.observer)||void 0===t||t.disconnect(),this.dom=null},e}(De),Ge=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Xe=function(t){function e(e,n){var o=t.call(this,e,n)||this;return console.log(e),o}return Ge(e,t),e.prototype.onLoad=function(){var t;(null===(t=this.parent.app)||void 0===t?void 0:t.renderer).plugins.interaction.autoPreventDefault=!1},e.prototype.onRelease=function(){},e}(De),Ye=function(){},He=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){t[t.NONE=0]="NONE",t[t.LOADING=1]="LOADING",t[t.READY=2]="READY",t[t.PLAYING=3]="PLAYING",t[t.PAUSED=4]="PAUSED",t[t.STOP=5]="STOP"}(Ie||(Ie={}));var ze=function(t){function e(e,n,o){var r=t.call(this,n.width,n.height)||this;return r.fps=30,r.plugs=new Map,r.status=Ie.NONE,vf.Ticker.shared.started||vf.Ticker.shared.start(),r.data=e,r.config=n,r.player=o,vf.gui.Utils.debug=n.debug,r.res=new je(r),r.variableManager=new F,r.soundManager=new B(r.res,r),r.tween=new vf.gui.Tween,new Ye,r}return He(e,t),Object.defineProperty(e.prototype,"systemEvent",{get:function(){return this.config.systemEvent},enumerable:!0,configurable:!0}),e.prototype.inputLog=function(t){void 0===t.message&&(t.message=""),t.target&&t.target.libId&&(t.message+=", id = "+t.target.id+" , libId = "+t.target.libId),this.player.runtimeLog(t)},e.prototype.start=function(){this.app&&this.app.ticker.add(this.onGUITickerUpdata,this),this.status=Ie.LOADING,this.res.on("LoadComplete",this.loadAssetCompleted,this),this.res.on("LoadProgress",this.loadProgress,this),this.res.loadData(this.data)},e.prototype.pause=function(){this.curScene&&(this.status=Ie.PAUSED,this.curScene.pause(),this.soundManager.pause())},e.prototype.resume=function(){this.curScene&&(this.curScene.resume(),this.soundManager.resume(),this.status=Ie.PLAYING)},e.prototype.reset=function(){this.status!==Ie.NONE&&this.status!==Ie.LOADING&&(this.curScene&&(this.curScene.dispose(),this.curScene=void 0),this.variableManager.clear(),this.soundManager.clear(),this.createScene())},e.prototype.dispose=function(){this.releaseAll(),this.curScene&&this.curScene.dispose(),this.tween&&this.tween.release(),this.app&&this.app.ticker&&(this.app.ticker.remove(this.onGUITickerUpdata,this),this.app.ticker.stop(),vf.Ticker.shared.stop()),this.res&&(this.res.off("LoadComplete",this.loadAssetCompleted,this),this.res.off("LoadProgress",this.loadProgress,this),this.res.destroy(),this.res=null),this.plugs.forEach((function(t){t.release()}))},e.prototype.getCurScene=function(){return this.curScene},e.prototype.switchToNextScene=function(t){if(this.curScene){var e=this.curScene.id,n=this.res.createNextScene(e,this);n&&this.switchToScene(n,t)}},e.prototype.switchToPrevScene=function(t){if(this.curScene){var e=this.curScene.id,n=this.res.createPrevScene(e,this);n&&this.switchToScene(n,t)}},e.prototype.switchToSceneId=function(t,e){var n=this.res.createScene(t,this);n&&this.switchToScene(n,e)},e.prototype.switchToScene=function(t,e){if(t&&this.app){var n=e,o=void 0;this.curScene&&((this.curScene.transition||n)&&(null==n&&(n=this.curScene.transition),o=function(t,e,n,o){var r=n||t.view.width,i=o||t.view.height,a=vf.RenderTexture.create({width:r,height:i,scaleMode:vf.SCALE_MODES.LINEAR});return t.renderer.render(e,a),a}(this.app,this.container,this.container.width,this.container.height)),this.removeChild(this.curScene),this.curScene.dispose()),this.curScene=t,this.curScene.width=this.width,this.curScene.height=this.height,this.addChild(t),n&&o?function(t,e,n){new R(t,e,n).run()}(this,o,n):(this.emit("TransitionStart"),this.emit("TransitionEnd"))}},e.prototype.loadAssetCompleted=function(t){this.systemEvent.emit("status",{code:"LoadComplete",level:"status",data:null}),this.status=Ie.READY,this.createScene(),this.createPlugs(),this.systemEvent.emit("status",{code:"sceneCreate",level:"status",data:null})},e.prototype.loadProgress=function(t){this.systemEvent.emit("status",{code:"LoadProgress",level:"status",data:t})},e.prototype.createPlugs=function(){for(var t=0,e=this.config.plugs;t<e.length;t++){var n=e[t],o=i[n.id];if(o)new o(n.id,this).load(n)}},e.prototype.createScene=function(){var t=this.res.createFirstScene(this);t&&(this.curScene=t,this.addChild(t)),this.status=Ie.PLAYING},e.prototype.onGUITickerUpdata=function(t){this.app&&vf.gui.TickerShared.update(t,this.app.ticker.lastTime,this.app.ticker.elapsedMS)},e}(vf.gui.Stage);function We(t){if(null===t)throw new Error("Error No find canvas parent dom");var e={};return e.width=t.offsetWidth,e.height=t.offsetHeight,e}function Je(t,e,n,o,r,i){void 0===r&&(r=1),void 0===i&&(i=!0);var a=We(t),s=a.width,c=a.height,u=function(t,e,n,o,r){var i=e,a=n,s=o,c=r,u=e/s||0,p=n/c||0;switch(t){case"showAll":u>p?i=Math.round(s*p):a=Math.round(c*u);break;case"cover":u>p?a=Math.round(c*u):i=Math.round(s*p);break;case"contain":u>p?s=Math.round(e/p):c=Math.round(n/u);break;default:s=e,c=n}return s%2!=0&&(s+=1),c%2!=0&&(c+=1),i%2!=0&&(i+=1),a%2!=0&&(a+=1),{stageWidth:s,stageHeight:c,displayWidth:i,displayHeight:a}}(o,s,c,n.width,n.height),p=u.stageWidth,l=u.stageHeight,h=u.displayWidth,f=u.displayHeight;e.style.transformOrigin="0% 0% 0px",e.width!==p&&(e.width=p),e.height!==l&&(e.height=l);e.style.top=0+(c-f)/2+"px",e.style.left=(s-h)/2+"px";var d=h/p,v=f/l,m=d*r,y=v*r;i||(m=Math.ceil(m),y=Math.ceil(y));var g=new vf.Matrix;return g.identity(),g.scale(d/m,v/y),g.rotate(0*Math.PI/180),e.style.position="absolute",e.style.transform="matrix("+g.a+","+g.b+","+g.c+","+g.d+","+g.tx+","+g.ty+")",e.width=p*m,e.height=l*y,n.container.hitArea=new vf.Rectangle(0,0,p,l),n.scaleX=m/r,n.scaleY=y/r,n._stageWidth=e.width/r,n._stageHeight=e.height/r,{width:e.width,height:e.height,scaleX:m,scaleY:y}}var qe=n(0),Ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ze=function(t){function e(){var e=t.call(this)||this;return e._observers=[],e}return Ke(e,t),e.prototype.emit=function(e,n){if(void 0===e)throw new Error("emitEvent ==> "+e+" is undefined");if(void 0===n.code)throw new Error("emitEvent ==> "+e+" args.code is undefined");if(void 0===n.level)throw new Error("emitEvent ==> "+e+" args.level is undefined");return t.prototype.emit.call(this,e,n)},e.prototype.emitExt=function(t,e,n){this.emit(t,{code:t,level:"command",data:e,target:n})},e.prototype.emitError=function(t,e,n,o){void 0===n&&(n="error"),this.error({code:t,level:n,data:e,message:t,target:o})},e.prototype.error=function(t){this.emit("status",t)},e}(qe.EventEmitter),Qe=function(){function t(){this.systemEvent=new Ze,this.PROPERTY_CHANGE=".Property.Changed",this.PROPERTY_SET_ERROR=".Property.SetError"}return t.prototype.on=function(t,e,n){return this.systemEvent.on(t,e,n),this},t.prototype.addListener=function(t,e,n){return this.on(t,e,n)},t.prototype.removeListener=function(t,e,n,o){return this.off(t,e,n,o)},t.prototype.off=function(t,e,n,o){return this.systemEvent.off(t,e,n,o),this},t.prototype.createRandomId=function(){var t=new Array("8","9","A","B");return this.createRandomIdentifier(8,15)+"-"+this.createRandomIdentifier(4,15)+"-8"+this.createRandomIdentifier(3,15)+"-"+t[this.randomIntegerWithinRange(0,3)]+this.createRandomIdentifier(3,15)+"-"+this.createRandomIdentifier(12,15)},t.prototype.getSessionId=function(){var t=new Date;return String(t.getTime())+String(1e3+t.getMilliseconds())+String(Math.floor(9e3*Math.random())+1e3)},t.prototype.propertyChange=function(t){this.systemEvent.emit("state",{code:this.getClassName(this)+this.PROPERTY_CHANGE,level:"status",data:{name:t,value:this[t]}})},t.prototype.propertyError=function(t,e){this.systemEvent.emit("state",{code:this.getClassName(this)+this.PROPERTY_SET_ERROR,level:"error",data:{name:t,value:e}})},Object.defineProperty(t.prototype,"info",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.output=function(t,e){for(var n in console.groupCollapsed(t),e)console.log("%c"+n+":","color: violet;",e[n]);console.groupEnd()},t.prototype.createRandomIdentifier=function(t,e){void 0===e&&(e=61);var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],o=[];for(e=e>61?61:e;t--;)o.push(n[this.randomIntegerWithinRange(0,e)]);return o.join("")},t.prototype.randomIntegerWithinRange=function(t,e){return Math.floor(Math.random()*(1+e-t)+t)},t.prototype.getClassName=function(t){var e=/function (.{1,})\(/.exec(t.constructor.toString());return e&&e.length>1?e[1]:""},t}(),$e=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},tn=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function en(t){var e=t;if(!(4===e.readyState&&e.status>=400)){var n={code:"0",level:"command",message:void 0,data:null};try{var o=e.response||e.responseText;switch(e.responseType){case"json":!function(t,e){try{e.data="string"==typeof t?JSON.parse(t):t}catch(t){return e.code="S0000",e.level="error",e.data=t,e}}(o,n);break;default:n.data=o}return n}catch(t){return n.code="S0002",n.level="error",n.data=e.responseURL+" , "+t,n}}}function nn(t,e){e&&(e.forEach((function(e){t.removeEventListener(e[0],e[1])})),e.length=0),t.onload=null,t.onerror=null,t.onreadystatechange=null}function on(t,e,n){return void 0===e&&(e={}),new Promise((function(o,r){var i={cur:0,max:e.errorCount||1},a=new XMLHttpRequest,s=e.method||"GET";a.timeout=e.timeout||0,a.responseType=e.responseType||"text",n&&n.forEach((function(t){a.addEventListener(t[0],t[1])})),a.onload=function(t){var e=en(t.target);if(e)return"error"===e.level?r(e):(nn(a,n),o(e.data))},a.onreadystatechange=function(e){if(void 0!==e){var o=e.currentTarget;if((2===o.readyState||4===o.readyState)&&o.status>=400){if(i.cur>=i.max)return nn(o,n),r({code:"S0001",level:"error",data:[o.responseURL||t,o.status]});i.cur++,o.abort(),o.open(s,t,!0),o.send()}}},a.onerror=function(e){var o=e.currentTarget;if(i.cur>=i.max)return nn(o,n),r({code:"S0001",level:"error",data:[o.responseURL||t,o.status]});i.cur++,o.abort(),o.open(s,t,!0),o.send()},a.open(s,t,!0),a.send()}))}function rn(t,e,n,o){return void 0===n&&(n={}),$e(this,void 0,void 0,(function(){var r,i,a,s;return tn(this,(function(c){switch(c.label){case 0:return 0!==e.length?[3,2]:[4,on(t,n,o)];case 1:return[2,c.sent()];case 2:i=0,a=e,c.label=3;case 3:return i<a.length?[4,on((a[i]||"")+t,n,o).catch((function(t){r=t}))]:[3,6];case 4:if(s=c.sent())return[2,s];c.label=5;case 5:return i++,[3,3];case 6:return[2,new Promise((function(t,e){e(r)}))]}}))}))}var an=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),sn=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},cn=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},un=function(t){function e(e){var n=t.call(this)||this;return n.lang="",n._readyState="init",n.lang=e.toLocaleLowerCase(),-1!==n.lang.indexOf("en")?n.lang="en-us":n.lang="zh-cn",n}return an(e,t),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._readyState},set:function(t){this._readyState=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){return["zh-CN","en-US"]},enumerable:!0,configurable:!0}),e.prototype.t=function(t,e){var n=this._data;return n&&n[t]?function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(null==t)return"";if(void 0===e)return t;var o,r=e.length;1==r&&Array.isArray(e[0])?r=(o=e[0]).length:o=e;for(var i=0;i<r;i++)t=t.replace(new RegExp("\\${"+i+"\\}","g"),o[i]);return t}(n[t].message.toString(),e):"This message code["+t+"] is not defined. \n JSON = "+JSON.stringify(e)},e.prototype.load=function(t,e){return sn(this,void 0,void 0,(function(){var n,o;return cn(this,(function(r){switch(r.label){case 0:return this.lang&&"ready"!==this._readyState?(n="",n="vf/engine/i18n/"+this.lang+".json?v=2",o=this,[4,rn(n,t,{responseType:"json"}).catch((function(t){e(t)}))]):[3,2];case 1:if(o._data=r.sent(),this._data)return this._readyState="ready",[2,!0];r.label=2;case 2:return[2,!1]}}))}))},e}(Qe),pn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ln=function(t){function e(e){var n=t.call(this)||this;return n._vfvars={},n._plugs=[],n.realFPS=!0,n._container=e.container,n.uuid=vf.utils.uid(),n._id=e.id||n.createRandomId(),n._src=e.src||void 0,n._play=void 0===e.play||Boolean(e.play),n._loop=void 0!==e.loop&&Boolean(e.loop),n._menu=void 0===e.menu||Boolean(e.menu),n._scaleMode=e.scaleMode||void 0,n._align=e.align||"tl",n._wmode=e.wmode||"transparent",n._bgcolor=e.bgcolor,n._vfvars=e.vfvars||{},n._frameRate=e.frameRate||30,n._width=e.width||320,n._height=e.height||240,n._orientation=e.orientation||"auto",n._maxTouches=e.maxTouches||2,n._showFPS=void 0===e.showFPS||Boolean(e.showFPS),n._showLog=void 0===e.showLog||Boolean(e.showLog),n._conversionData=e.conversionData,n._debug=e.debug||!1,n._plugs=e.plugs||n._plugs,n._logAdvancedTrace=e.logAdvancedTrace||!1,n.cdns=Array.isArray(e.vfvars.cdns)?{default:e.vfvars.cdns}:e.vfvars.cdns,void 0===n.cdns.image&&(n.cdns.image=n.cdns.default.concat()),void 0===n.cdns.media&&(n.cdns.media=n.cdns.default.concat()),void 0===n.cdns.wx&&(n.cdns.wx=n.cdns.default.concat()),n._language=e.language||vf.utils.getSystemInfo().language,n._i18n=new un(n._language),n.realFPS=!1!==e.realFPS,n}return pn(e,t),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},set:function(t){this._container!==t&&(this._container=t,this.propertyChange("container"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(t){this._id!==t&&(this._id=t,this.propertyChange("id"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(t){this._src!==t&&(this._src=t,this.propertyChange("src"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"play",{get:function(){return this._play},set:function(t){this._play!==t&&(this._play=t,this.propertyChange("play"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop!==t&&(this._loop=t,this.propertyChange("loop"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"menu",{get:function(){return this._menu},set:function(t){this._menu!==t&&(this._menu=t,this.propertyChange("menu"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.propertyChange("scaleMode"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.propertyChange("align"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wmode",{get:function(){return this._wmode},set:function(t){this._wmode!==t&&(this._wmode=t,this.propertyChange("wmode"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgcolor",{get:function(){return this._bgcolor},set:function(t){this._bgcolor!==t&&(this._bgcolor=t,this.propertyChange("bgcolor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vfvars",{get:function(){return this._vfvars},set:function(t){this._vfvars!==t&&(this._vfvars=t,this.propertyChange("vfvars"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plugs",{get:function(){return this._plugs},set:function(t){this._plugs=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate!==t&&(this._frameRate=t,this.propertyChange("frameRate"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.propertyChange("width"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.propertyChange("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation!==t&&(this._orientation=t,this.propertyChange("orientation"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTouches",{get:function(){return this._maxTouches},set:function(t){this._maxTouches!==t&&(this._maxTouches=t,this.propertyChange("maxTouches"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showFPS",{get:function(){return this._showFPS},set:function(t){this._showFPS!==t&&(this._showFPS=t,this.propertyChange("showFPS"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showLog",{get:function(){return this._showLog},set:function(t){this._showLog!==t&&(this._showLog=t,this.propertyChange("showLog"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conversionData",{get:function(){return this._conversionData},set:function(t){this._conversionData!==t&&(this._conversionData=t,this.propertyChange("conversionData"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(t){this._debug!==t&&(this._debug=t,this.propertyChange("debug"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logAdvancedTrace",{get:function(){return this._logAdvancedTrace},set:function(t){this._logAdvancedTrace!==t&&(this._logAdvancedTrace=t,this.propertyChange("logAdvancedTrace"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this._language},set:function(t){this._language!==t&&(this._language=t,this.propertyChange("language"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"i18n",{get:function(){return this._i18n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){return{container:this.container,id:this.id,src:this.src,play:this.play,loop:this.loop,menu:this.menu,scaleMode:this.scaleMode,align:this.align,wmode:this.wmode,bgcolor:this.bgcolor,vfvars:this.vfvars,plugs:this.plugs,frameRate:this.frameRate,width:this.width,height:this.height,orientation:this.orientation,maxTouches:this.maxTouches,showFPS:this.showFPS,showLog:this.showLog,logAdvancedTrace:this.logAdvancedTrace,conversionData:this.conversionData,debug:this.debug,language:this.language,i18n:this.i18n.info}},enumerable:!0,configurable:!0}),e}(Qe),hn=function(){function t(t,e){if(this._config=t,this._showCode="",e){this._errPanel=document.createElement("div"),this._errPanel.style.background="rgba(0,0,0,0.8)",this._errPanel.style.position="absolute",this._errPanel.style.width="100%",this._errPanel.style.height="100%",this._errPanel.style.zIndex="8088",this._errPanel.style.display="none";var n=document.createElement("span");n.style.display="table-cell",n.style.verticalAlign="middle",n.style.textAlign="center",n.style.color="#eee",this._errPanel.appendChild(n),this._config.container.appendChild(this._errPanel),this._config.i18n.addListener("state",this.onChange,this)}}return t.prototype.setMessage=function(t,e){if(t&&this._errPanel){this._showCode=t,this._errPanel.style.display="table";var n=this._errPanel.children[0];n.hasChildNodes()&&n.removeChild(n.childNodes[0]);var o=document.createTextNode(this.getText(t,e));n.appendChild(o)}},t.prototype.getText=function(t,e){return this._config.i18n.t(t,e)+" #"+t},t.prototype.close=function(){this._showCode="",this._errPanel&&(this._errPanel.style.display="none")},t.prototype.onChange=function(t){this._showCode&&"I18N.Property.Changed"===t.code&&this.setMessage(this._showCode)},t}(),fn=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},dn=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},vn=function(){function t(t){this.onError=function(t){},this.onInit=function(){},this.onReady=function(){},this.onSceneCreate=function(){},this.onMessage=function(t){},this.onDispose=function(){},this.config=new ln(t);var e=this.config;console.groupEnd(),this.app=new vf.Application({backgroundColor:parseInt(e.bgcolor||"0",16),transparent:"transparent"===e.wmode,antialias:!0,resolution:t.resolution,forceCanvas:t.forceCanvas}),this._errpanel=new hn(this.config,t.useCustomErrorPanel),this.initSystemEvent(),this._readyState="init",this.config.src&&this.play(this.config.src)}return Object.defineProperty(t.prototype,"readyState",{get:function(){return this._readyState},set:function(t){this._readyState=t,this.config.systemEvent.emit("status",{code:t,level:"status",data:t})},enumerable:!0,configurable:!0}),t.prototype.play=function(t){return fn(this,void 0,void 0,(function(){return dn(this,(function(e){return"init"!==this._readyState&&"loaded"!==this._readyState&&this.reload(),this.loadData(t),[2]}))}))},t.prototype.playData=function(t,e){e&&(this.config.conversionData=e),this.play(t)},t.prototype.pause=function(){this.stage&&this.stage.pause()},t.prototype.resume=function(){this.stage&&this.stage.resume()},t.prototype.reset=function(){this.stage&&this.stage.reset()},t.prototype.message=function(t){this.config.systemEvent.emit("onMessage",t)},t.prototype.runtimeLog=function(t){this.onMessage&&this.onMessage(t)},t.prototype.switchToNextScene=function(t){this.stage&&this.stage.switchToNextScene(t)},t.prototype.switchToPrevScene=function(t){this.stage&&this.stage.switchToPrevScene(t)},t.prototype.switchToSceneId=function(t,e){this.stage&&this.stage.switchToSceneId(t,e)},t.prototype.dispose=function(t){void 0===t&&(t=!1),"disabled"!==this.readyState&&(this.config.systemEvent.removeAllListeners(),this.stage&&this.stage.dispose(),vf.AudioEngine.Ins().dispose(),this.app&&this.app.stage&&this.app.destroy(t,{children:!0,texture:!0,baseTexture:!0}),this.onDispose(),this.readyState="disabled")},t.prototype.initSystemEvent=function(){var t=this.config.systemEvent;t.on("message",this.sendMessage,this),t.on("status",this.onStatus,this)},t.prototype.reload=function(){this.config.systemEvent.removeAllListeners(),this.stage&&this.stage.dispose(),this.app&&this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.initSystemEvent()},t.prototype.start=function(){return fn(this,void 0,void 0,(function(){var t,e,n,o,r;return dn(this,(function(i){return this._data?(t=this.config,e=this._data,n=this.config.container,o=We(n),t.width=vf.gui.Utils.formatRelative(e.width,o.width),t.height=vf.gui.Utils.formatRelative(e.height,o.height),void 0===t.scaleMode&&(t.scaleMode=this._data.scaleMode||"noScale"),t.output("Config Info：",t.info),(r=this.app.view).width=t.width,r.height=t.height,r.style.zIndex="0",n.appendChild(this.app.view),this.stage=new ze(this._data,this.config,this),this.stage.app=this.app,this.app.stage.addChild(this.stage.container),Je(n,this.app.view,this.stage,this.config.scaleMode,this.app.renderer.resolution),this.readyState="ready",this.stage.start(),[2]):[2]}))}))},t.prototype.loadData=function(t){return fn(this,void 0,void 0,(function(){var e,n,o,r,i=this;return dn(this,(function(a){switch(a.label){case 0:return this.readyState="load",e=this.onStatus.bind(this),[4,this.config.i18n.load(this.config.cdns.default,e)];case 1:return a.sent(),"string"!=typeof t?[3,3]:(n=this,[4,on(t,{responseType:"json"}).catch((function(t){e(t)}))]);case 2:return n._data=a.sent(),[3,4];case 3:"object"==typeof t&&(this._data=t),a.label=4;case 4:return(o=this._data)?o.conversion?"string"!=typeof t?[3,8]:(r=t.split("?")[1]||"v=0",[4,Me(t.substr(0,t.lastIndexOf("/"))+"/"+o.conversion+"?"+r).catch((function(t){i.onStatus(t)}))]):[3,9]:[3,11];case 5:return a.sent(),[4,new window.VFConversion];case 6:return[4,a.sent().analysis(this.config.conversionData,this._data)];case 7:return a.sent(),[3,9];case 8:this.onStatus({code:"E0005",level:"error",data:o.conversion}),a.label=9;case 9:return this.readyState="loaded",[4,this.start()];case 10:a.sent(),a.label=11;case 11:return[2]}}))}))},t.prototype.sendMessage=function(t){this.onMessage(t)},t.prototype.onStatus=function(t){if("error"===t.level||"warning"===t.level)return"error"===t.level&&this._errpanel.setMessage(t.code,t.data),t.message=this._errpanel.getText(t.code,t.data),void(this.onError&&this.onError(t));switch(t.code){case"init":this.onInit&&this.onInit();break;case"ready":this.onReady&&this.onReady();break;case"sceneCreate":this.onSceneCreate&&this.onSceneCreate();break;default:this.onMessage&&this.onMessage(t)}},t}(),mn=window;void 0===mn.vf&&(mn.vf={}),mn.vf.player={Player:vn},n.d(e,"Player",(function(){return vn}))}])}));